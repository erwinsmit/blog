{"componentChunkName":"component---src-templates-blog-post-js","path":"/add-external-datasource-to-sitecore-jss/","webpackCompilationHash":"7fc97ac80e7a33ec2715","result":{"data":{"site":{"siteMetadata":{"title":"Erwin Smit blog","author":"Erwin Smit"}},"markdownRemark":{"id":"338fa798-29d3-520a-98bf-9f578902751a","html":"<h2 id=\"sitecore-jss-graphql-out-of-the-box\"><a href=\"#sitecore-jss-graphql-out-of-the-box\" aria-label=\"sitecore jss graphql out of the box permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Sitecore JSS GraphQL out of the box</h2>\n<p>The Sitecore JSS Next.js SDK has great built-in <a href=\"https://doc.sitecore.com/en/developers/hd/190/sitecore-headless-development/use-graphql-to-fetch-component-level-data-in-jss-next-js-apps.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">tooling</a> for querying the Sitecore GraphQL endpoint.\nIn this blog post, I will explain how to use the same tooling but for external data sources. </p>\n<h2 id=\"consume-external-graphql-api\"><a href=\"#consume-external-graphql-api\" aria-label=\"consume external graphql api permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Consume external Graphql API</h2>\n<p>For demo purposes, I picked the excellent API from GitHub. This is free to use, the only thing you need is a <a href=\"https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/creating-a-personal-access-token\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">personal access token</a>. When that’s all set up you can use the <a href=\"https://docs.github.com/en/graphql/overview/explorer\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">explorer</a> to explore all the data you can fetch. </p>\n<h3 id=\"extend-introspection-script\"><a href=\"#extend-introspection-script\" aria-label=\"extend introspection script permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Extend introspection script</h3>\n<p>Sitecore JSS uses <a href=\"https://github.com/piglovesyou/graphql-let\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">graphql-let</a> for automatically generating types for the GraphQL results. A .graphql file is automatically picked up by this tool. It analyses the query and as a result, generates a .d.ts file next to it.\nWith this .d.ts file you can import the required types:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> GithubUserSearchQuery <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"./userSearch.github.graphql\"</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Before this is possible graphql-let needs an introspection schema. The schema is created by the <a href=\"https://doc.sitecore.com/en/developers/hd/190/sitecore-headless-development/introspecting-the-graphql-schema-in-jss-next-js-apps.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">graphl-update</a> task.</p>\n<p>To add the GitHub introspection schema we need to extend the script <code class=\"language-text\">scripts\\fetch-graphql-introspection-data.ts</code> with an introspection call to the GitHub GraphQL endpoint:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token punctuation\">(</span><span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  \n  <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> introSpectionQuery <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">const</span> githubResults <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"https://api.github.com/graphql\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n      method<span class=\"token punctuation\">:</span> <span class=\"token string\">\"POST\"</span><span class=\"token punctuation\">,</span>\n      headers<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"Content-Type\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"application/json\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"Authorization\"</span><span class=\"token punctuation\">:</span> <span class=\"token template-string\"><span class=\"token string\">`bearer </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">GHUB_PRIVATE_KEY</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">`</span></span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      body<span class=\"token punctuation\">:</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>introSpectionQuery<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">const</span> githubData <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> githubResults<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    fs<span class=\"token punctuation\">.</span><span class=\"token function\">writeFile</span><span class=\"token punctuation\">(</span>\n      <span class=\"token string\">\"./src/temp/GraphQLIntrospectionResultGithub.json\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>githubData<span class=\"token punctuation\">,</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">(</span><span class=\"token parameter\">err</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Error writing GraphQLIntrospectionResultGithub file\"</span><span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"GraphQL Github Introspection Data successfully fetched!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    process<span class=\"token punctuation\">.</span><span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>I used this <a href=\"https://gist.github.com/craigbeck/b90915d49fda19d5b2b17ead14dcd6da\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">introspection query</a> to get all the required types.\nNow when you run <strong>npm run update:graphql</strong> you get a nice big schema with all the types from the GitHub GraphQL API.</p>\n<h3 id=\"add-additional-graphql-let-configuration-file\"><a href=\"#add-additional-graphql-let-configuration-file\" aria-label=\"add additional graphql let configuration file permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Add additional graphql-let configuration file</h3>\n<p>To point graphql-let to this schema file I’ve added this file to the root of the project <strong>.graphql-let-github</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\">    <span class=\"token key atrule\">schema</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token string\">'./src/temp/GraphQLIntrospectionResultGithub.json'</span>\n    <span class=\"token key atrule\">documents</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'src/**/*.github.graphql'</span>\n    <span class=\"token key atrule\">plugins</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> typescript\n    <span class=\"token punctuation\">-</span> typescript<span class=\"token punctuation\">-</span>operations\n    <span class=\"token punctuation\">-</span> typed<span class=\"token punctuation\">-</span>document<span class=\"token punctuation\">-</span>node\n\n    <span class=\"token key atrule\">cacheDir</span><span class=\"token punctuation\">:</span> .generated\n    <span class=\"token key atrule\">config</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">useIndexSignature</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span></code></pre></div>\n<p>Change the <strong>bootstrap</strong> npm script to:</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token property\">\"bootstrap\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ts-node --project tsconfig.scripts.json scripts/bootstrap.ts &amp;&amp; graphql-let &amp;&amp; graphql-let --config .graphql-let-github.yml\"</span></code></pre></div>\n<p>This generates all the types when running <strong>npm start</strong></p>\n<p>To also receive updated types while you’re actively developing update <strong>next.config.js</strong> with the following lines:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">applyGraphQLCodeGenerationLoaders</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">config<span class=\"token punctuation\">,</span> options</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  config<span class=\"token punctuation\">.</span>module<span class=\"token punctuation\">.</span>rules<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    test<span class=\"token punctuation\">:</span> <span class=\"token regex\">/\\.sitecore.graphql$/</span><span class=\"token punctuation\">,</span>\n    exclude<span class=\"token punctuation\">:</span> <span class=\"token regex\">/node_modules/</span><span class=\"token punctuation\">,</span>\n    use<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>options<span class=\"token punctuation\">.</span>defaultLoaders<span class=\"token punctuation\">.</span>babel<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> loader<span class=\"token punctuation\">:</span> <span class=\"token string\">'graphql-let/loader'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n  config<span class=\"token punctuation\">.</span>module<span class=\"token punctuation\">.</span>rules<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    test<span class=\"token punctuation\">:</span> <span class=\"token regex\">/\\.github.graphql$/</span><span class=\"token punctuation\">,</span>\n    exclude<span class=\"token punctuation\">:</span> <span class=\"token regex\">/node_modules/</span><span class=\"token punctuation\">,</span>\n    use<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>options<span class=\"token punctuation\">.</span>defaultLoaders<span class=\"token punctuation\">.</span>babel<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> loader<span class=\"token punctuation\">:</span> <span class=\"token string\">'graphql-let/loader'</span><span class=\"token punctuation\">,</span> options<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> configFile<span class=\"token punctuation\">:</span> <span class=\"token string\">\".graphql-let-github.yml\"</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>As you see I suffix the Sitecore GraphQL queries with <strong>.sitecore.graphql</strong> and the GitHub queries with <strong>.github.graphql</strong>. Because both types of queries have their own configuration.</p>\n<h3 id=\"add-a-query-to-a-component\"><a href=\"#add-a-query-to-a-component\" aria-label=\"add a query to a component permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Add a query to a component</h3>\n<p>Now that’s all in place we can add some GraphQL data to a component. Next to the component that will consume the data, we will create <strong>userSearch.github.graphql</strong>:</p>\n<div class=\"gatsby-highlight\" data-language=\"graphql\"><pre class=\"language-graphql\"><code class=\"language-graphql\"><span class=\"token keyword\">query</span> githubUserSearch<span class=\"token punctuation\">(</span><span class=\"token variable\">$organisation</span><span class=\"token punctuation\">:</span> String<span class=\"token operator\">!</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> \n  organization<span class=\"token punctuation\">(</span><span class=\"token attr-name\">login</span><span class=\"token punctuation\">:</span> <span class=\"token variable\">$organisation</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    membersWithRole<span class=\"token punctuation\">(</span><span class=\"token attr-name\">first</span><span class=\"token punctuation\">:</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      nodes <span class=\"token punctuation\">{</span>\n        <span class=\"token operator\">...</span> <span class=\"token keyword\">on</span> <span class=\"token class-name\">User</span> <span class=\"token punctuation\">{</span>\n          name<span class=\"token punctuation\">,</span> \n          company<span class=\"token punctuation\">,</span>\n          email<span class=\"token punctuation\">,</span>\n          avatarUrl<span class=\"token punctuation\">,</span>\n          location<span class=\"token punctuation\">,</span>\n          login\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>This query accepts an Organisation as a parameter. The query asks for the first 100 members of the organisation found. Within the nodes, the User Fragment is used to get a couple of properties of each user. </p>\n<p>To get this data into the component as static props (so the query is done on build-time) the method <strong>getStaticProps</strong> needs to be exported. With Next.js this can usually only be done on page level but Sitecore JSS added some magic to also allow this on component level:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> query <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'raw-loader!./userSearch.github.graphql'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>default<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> getStaticProps<span class=\"token punctuation\">:</span> <span class=\"token function-variable function\">GetStaticComponentProps</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">rendering</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> githubResults <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"https://api.github.com/graphql\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n      method<span class=\"token punctuation\">:</span> <span class=\"token string\">\"POST\"</span><span class=\"token punctuation\">,</span>\n      headers<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"Content-Type\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"application/json\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"Authorization\"</span><span class=\"token punctuation\">:</span> <span class=\"token template-string\"><span class=\"token string\">`bearer </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">GHUB_PRIVATE_KEY</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">`</span></span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      \n      body<span class=\"token punctuation\">:</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        query<span class=\"token punctuation\">:</span> query<span class=\"token punctuation\">,</span>\n        variables<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> organisation<span class=\"token punctuation\">:</span> rendering<span class=\"token punctuation\">.</span>fields<span class=\"token operator\">?</span><span class=\"token punctuation\">.</span>organisation<span class=\"token operator\">?</span><span class=\"token punctuation\">.</span>value <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">const</span> githubData <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> githubResults<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">return</span> githubData<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>The organisation field is passed down from Sitecore, so the content editor can pick the GitHub organisation. <a href=\"https://doc.sitecore.com/en/developers/hd/190/sitecore-headless-development/create-a-new-component-in-a-jss-next-js-app-using-the-code-first-development-workflow.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Read more</a> on how to add fields to components using the JSS Cli (I prefer this over clicking away in the Sitecore admin).</p>\n<p>Within the component the data can now be consumed with the <strong>useComponentProps</strong> hook:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> GetStaticComponentProps <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@sitecore-jss/sitecore-jss-nextjs\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> GithubUserSearchQuery <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"./userSearch.github.graphql\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> UserSearch<span class=\"token punctuation\">:</span> React<span class=\"token punctuation\">.</span><span class=\"token constant\">FC</span><span class=\"token operator\">&lt;</span>UserSearchProps<span class=\"token operator\">></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> fields<span class=\"token punctuation\">,</span> rendering <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token constant\">JSX</span><span class=\"token punctuation\">.</span><span class=\"token parameter\">Element</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> data <span class=\"token operator\">=</span> rendering<span class=\"token punctuation\">.</span>uid <span class=\"token operator\">?</span> useComponentProps<span class=\"token operator\">&lt;</span>GithubUserSearchQuery<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>rendering<span class=\"token punctuation\">.</span>uid<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">:</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>With the type added to the <strong>useComponentProps</strong> function we get IntelliSense based on the query we created, how cool is that! </p>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d02c01fff0914e2ea6adb87fffc18f25/9ae17/vscode.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 900px;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 38.76288659793814%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAIABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAByAQH/8QAFBABAAAAAAAAAAAAAAAAAAAAEP/aAAgBAQABBQJ//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAEP/aAAgBAQAGPwJ//8QAFhABAQEAAAAAAAAAAAAAAAAAABEB/9oACAEBAAE/Ibiq/9oADAMBAAIAAwAAABDwD//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABkQAAMBAQEAAAAAAAAAAAAAAAABIRFBUf/aAAgBAQABPxCC1Pe0cuKmvT//2Q=='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"Intellisense\"\n        title=\"\"\n        src=\"/static/d02c01fff0914e2ea6adb87fffc18f25/2a9fa/vscode.jpg\"\n        srcset=\"/static/d02c01fff0914e2ea6adb87fffc18f25/f0518/vscode.jpg 225w,\n/static/d02c01fff0914e2ea6adb87fffc18f25/b3492/vscode.jpg 450w,\n/static/d02c01fff0914e2ea6adb87fffc18f25/2a9fa/vscode.jpg 900w,\n/static/d02c01fff0914e2ea6adb87fffc18f25/987c3/vscode.jpg 1350w,\n/static/d02c01fff0914e2ea6adb87fffc18f25/e2107/vscode.jpg 1800w,\n/static/d02c01fff0914e2ea6adb87fffc18f25/9ae17/vscode.jpg 2425w\"\n        sizes=\"(max-width: 900px) 100vw, 900px\"\n      />\n  </span>\n  </a></p>","timeToRead":5,"frontmatter":{"title":"Add external datasource to Sitecore JSS","date":"November 23, 2021","spoiler":"Consuming external GraphQL API"},"fields":{"slug":"/add-external-datasource-to-sitecore-jss/","langKey":"en"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/add-external-datasource-to-sitecore-jss/","previous":{"fields":{"slug":"/sitecore-jss-on-azure-functions/","langKey":"en","directoryName":"sitecore-jss-on-azure-functions"},"frontmatter":{"title":"Sitecore JSS on Azure Functions"}},"next":{"fields":{"slug":"/ordercloud-sitecore-jss-nextjs/","langKey":"en","directoryName":"ordercloud-sitecore-jss-nextjs"},"frontmatter":{"title":"Integrate OrderCloud with Sitecore JSS Next.js"}},"translations":[],"translatedLinks":[]}}}