<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/a34f9d1faa5f3315-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" as="image" href="/blog/spaData.jpg"/><link rel="preload" as="image" href="/blog/firebase.png"/><link rel="preload" as="image" href="/blog/getFilms.png"/><link rel="preload" as="image" href="/blog/getWatchlistitems.png"/><link rel="stylesheet" href="/_next/static/css/3e1713d87a54c95d.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/3a398bc4ce4edcc7.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-8af1d2e0ff41d756.js"/><script src="/_next/static/chunks/4bd1b696-23516f99b565b560.js" async=""></script><script src="/_next/static/chunks/215-caa2c8b8fefad047.js" async=""></script><script src="/_next/static/chunks/main-app-8359a3fe9e3783b5.js" async=""></script><script src="/_next/static/chunks/231-c96e92b4cbbab7e2.js" async=""></script><script src="/_next/static/chunks/app/blog/page-19199c8b99a973b9.js" async=""></script><script src="/_next/static/chunks/app/not-found-84a7f5eea0d523d6.js" async=""></script><meta name="next-size-adjust"/><link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png"/><link rel="manifest" href="/favicon/site.webmanifest"/><link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" color="#000000"/><link rel="shortcut icon" href="/favicon/favicon.ico"/><meta name="msapplication-TileColor" content="#000000"/><meta name="msapplication-config" content="/favicon/browserconfig.xml"/><meta name="theme-color" content="#000"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><title>Exploring the apollo graphql stack</title><meta name="description" content="Erwin Smit - Freelance frontend developer / fullstack developer"/><meta property="og:title" content="Exploring the apollo graphql stack"/><meta property="og:description" content="Erwin Smit - Freelance frontend developer / fullstack developer"/><meta name="twitter:card" content="summary"/><meta name="twitter:title" content="Exploring the apollo graphql stack"/><meta name="twitter:description" content="Erwin Smit - Freelance frontend developer / fullstack developer"/><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="bg-gray-100 "><header class="bg-blue-600 text-white shadow-md"><div class="container mx-auto px-4 py-6"><nav><ul class="flex justify-center space-x-6"><li><a class="hover:text-blue-200 transition duration-150 ease-in-out" href="/">About me</a></li><li><a class="hover:text-blue-200 transition duration-150 ease-in-out" href="/blog">Blog</a></li></ul></nav></div></header><main class="min-h-screen"><article class="max-w-7xl mx-auto px-8 my-12"><h1 class="w-full relative mb-8 text-6xl font-extrabold tracking-normal text-center title-font"><span class="bg-clip-text text-transparent bg-gradient-to-b from-blue-600 to-blue-500">Exploring the apollo graphql stack</span></h1><div class="flex items-center justify-center mb-16"><p class="text-base font-medium text-gray-600 group-hover:text-gray-800"><time dateTime="2020-02-15">February	15, 2020</time></p></div><div class="prose lg:prose-xl max-w-none prose-pre:p-0"><h2>Why?</h2>
<p>At a project I&#x27;m working on we have to build a single page application with authentication that needs to query data from multiple data services.</p>
<p>There are also a lot of examples where we need to &#x27;stitch&#x27; these services together. Let&#x27;s have a look at the domain model and the corresponding services:</p>
<p><img src="/blog/spaData.jpg" alt="alt text" title="data setup"/></p>
<p>Note that I&#x27;m not really a pro drawing things with draw.io...
But you get the point, if we fetch service requests for example. We also have to get the related entity &amp; portfolio for every single service request. Currently we do this with separate api calls and it works but it complicates loading states and it makes the frontend application harder to work with.</p>
<p>Would it not be nice to get a list of service requests, without having to create 3 api calls from the frontend? Of course this can all be done on the server, but if the requirements change all needs to be updated. For example, if the business decides it doesn&#x27;t want entity information on a service request we can remove it from the frontend but the server will still fetch all the data, what a waste! This is where graphql shines, there is a clear connection between the client and the server on the data it actually needs.</p>
<p>Graphql provides a nice query language for querying the date you want with nested objects supported as well.</p>
<p>A query for fetching service requests with the related entities and portfolios would look like this:</p>
<pre><code class="hljs language-graphql"><span class="hljs-keyword">query</span> getServiceRequests <span class="hljs-punctuation">{</span>
  ServiceRequests <span class="hljs-punctuation">{</span>
    entity <span class="hljs-punctuation">{</span>
      name
      address
    <span class="hljs-punctuation">}</span>
    portfolio <span class="hljs-punctuation">{</span>
      name
      address
    <span class="hljs-punctuation">}</span>
    name
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>This query will return a list with the service requests but with the entity and portfolio objects already embedded, nice!</p>
<p>To actually perform this query and stitch all the data together we can use &quot;Apollo Federation&quot;:
<a href="https://www.apollographql.com/docs/apollo-server/federation/introduction/">https://www.apollographql.com/docs/apollo-server/federation/introduction/</a></p>
<h2>Watchlist sideproject</h2>
<p>I decided to have a play with this using a hobby project. This project called &quot;watchlist&quot; allows me to search for films and add them to my watchlist. I would like to expand it with ratings and sharing functionality but that&#x27;s for later.</p>
<p>I decided on using themoviedb.org as a source for the films and firebase.google.com for saving films to my watchlist.</p>
<p>The watchlist items are saved in firebase in this structure:</p>
<p><img src="/blog/firebase.png" alt="alt text" title="data setup"/></p>
<p>Firebase is using a folder structure, userId is used to group all the watchlist items under the correct user. This way I can simply query everything from a specific directory knowing that it&#x27;s all scoped to the correct user.</p>
<p>Eventually I would like to query films and find out from each film if it&#x27;s added to watchlist yet.</p>
<p>The other way round I want to query my watchlist and have all the film information embbeded without having to query the filmservice separately.</p>
<h2>Setting up the apollo gateway</h2>
<p>To use Apollo federation you have to create separate services which can be tied together with a &quot;gateway&quot;.</p>
<p>The gateway looks like this:</p>
<pre><code class="hljs language-javascript"><span class="hljs-keyword">const</span> gateway = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ApolloGateway</span>({
  <span class="hljs-attr">serviceList</span>: [
    { <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;watchListItems&quot;</span>, <span class="hljs-attr">url</span>: <span class="hljs-string">&quot;http://localhost:5002&quot;</span> },
    { <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;films&quot;</span>, <span class="hljs-attr">url</span>: <span class="hljs-string">&quot;http://localhost:5003&quot;</span> },
  ],
  <span class="hljs-title function_">buildService</span>(<span class="hljs-params">{ name, url }</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AuthenticatedDataSource</span>({ url });
  },
});
</code></pre>
<p>Because I can only return watchlistitems if the user is authenticated I have to pass an Auth token from my frontend application. In the gateway this token is translated into a userId. The userId is placed on the context, context is a mechanism that allows apollo server to add variables to a global scope which can be accessed anywhere within the scope of the request.</p>
<pre><code class="hljs language-javascript"><span class="hljs-keyword">const</span> server = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ApolloServer</span>({
  gateway,
  <span class="hljs-attr">context</span>: <span class="hljs-title function_">async</span> ({ req, context }) =&gt; {
    <span class="hljs-keyword">const</span> token = req.<span class="hljs-property">headers</span>.<span class="hljs-property">authorization</span> || <span class="hljs-string">&quot;&quot;</span>;
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> user = <span class="hljs-keyword">await</span> firebaseApp.<span class="hljs-title function_">auth</span>().<span class="hljs-title function_">verifyIdToken</span>(token);
      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">userId</span>: user.<span class="hljs-property">user_id</span>,
      };
    } <span class="hljs-keyword">catch</span> (e) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(e);
      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">userId</span>: <span class="hljs-literal">undefined</span>,
      };
    }
  },
  <span class="hljs-attr">subscriptions</span>: <span class="hljs-literal">false</span>,
});
</code></pre>
<p>The context only lives within the &#x27;gateway&#x27; not in the underlying services. So after the userId is extracted from the token we pass it through using the http headers.</p>
<pre><code class="hljs language-javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">AuthenticatedDataSource</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">RemoteGraphQLDataSource</span> {
  <span class="hljs-title function_">willSendRequest</span>(<span class="hljs-params">{ request, context }</span>) {
    <span class="hljs-keyword">if</span> (context.<span class="hljs-property">userId</span>) {
      request.<span class="hljs-property">http</span>.<span class="hljs-property">headers</span>.<span class="hljs-title function_">set</span>(<span class="hljs-string">&quot;userid&quot;</span>, context.<span class="hljs-property">userId</span>);
    }
  }
}
</code></pre>
<h2>Creating the films service</h2>
<p>The typedefs for this service are as follows:</p>
<pre><code class="hljs language-graphql"><span class="hljs-keyword">type</span> Film <span class="hljs-meta">@key</span><span class="hljs-punctuation">(</span><span class="hljs-symbol">fields</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;id&quot;</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">{</span>
  <span class="hljs-symbol">id</span><span class="hljs-punctuation">:</span> ID<span class="hljs-punctuation">!</span>
  <span class="hljs-symbol">posterPath</span><span class="hljs-punctuation">:</span> String
  <span class="hljs-symbol">title</span><span class="hljs-punctuation">:</span> String<span class="hljs-punctuation">!</span>
  <span class="hljs-symbol">watchListItem</span><span class="hljs-punctuation">:</span> WatchListItem <span class="hljs-meta">@provides</span><span class="hljs-punctuation">(</span><span class="hljs-symbol">fields</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;filmId&quot;</span><span class="hljs-punctuation">)</span>
<span class="hljs-punctuation">}</span>

extend <span class="hljs-keyword">type</span> WatchListItem <span class="hljs-meta">@key</span><span class="hljs-punctuation">(</span><span class="hljs-symbol">fields</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;filmId&quot;</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">{</span>
  <span class="hljs-symbol">filmId</span><span class="hljs-punctuation">:</span> String<span class="hljs-punctuation">!</span> <span class="hljs-meta">@external</span>
  <span class="hljs-symbol">id</span><span class="hljs-punctuation">:</span> ID<span class="hljs-punctuation">!</span> <span class="hljs-meta">@external</span>
<span class="hljs-punctuation">}</span>

<span class="hljs-keyword">type</span> <span class="hljs-keyword">Query</span> <span class="hljs-punctuation">{</span>
  <span class="hljs-symbol">films</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>Film<span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>By adding @key(fields: &quot;id&quot;) to Film we ensure this type will be able to referenced by other services.
In the Film type there is a reference to WatchListItem, because this will be resolved by other services we add the @provides keyword with the field &quot;filmId&quot; which can be used to resolve the type.</p>
<p>The WatchListItem item lives in another service, so we need to create an extension in this services. That&#x27;s done by the &quot;extend type&quot; keyword.</p>
<p>Resolvers:</p>
<pre><code class="hljs language-javascript"><span class="hljs-keyword">const</span> resolvers = {
  <span class="hljs-title class_">Query</span>: {
    <span class="hljs-title function_">films</span>(<span class="hljs-params">parentValue, args, { dataSources }</span>) {
      <span class="hljs-keyword">return</span> dataSources.<span class="hljs-property">filmsApi</span>.<span class="hljs-title function_">getTrendingFilms</span>();
    },
  },
  <span class="hljs-title class_">Film</span>: {
    <span class="hljs-title function_">__resolveReference</span>(<span class="hljs-params">reference, { dataSources }</span>) {
      <span class="hljs-keyword">return</span> dataSources.<span class="hljs-property">filmsApi</span>.<span class="hljs-title function_">getFilmById</span>(reference.<span class="hljs-property">id</span>);
    },
    <span class="hljs-title function_">watchListItem</span>(<span class="hljs-params">film, args</span>) {
      <span class="hljs-keyword">return</span> { <span class="hljs-attr">__typename</span>: <span class="hljs-string">&quot;WatchListItem&quot;</span>, <span class="hljs-attr">filmId</span>: film.<span class="hljs-property">id</span>, <span class="hljs-attr">userId</span>: args.<span class="hljs-property">userId</span> };
    },
  },
};
</code></pre>
<p>To resolve the watchListItem type we need to add a resolver that provides the correct fields to the external service. That&#x27;s done with the this line <code>return { __typename: &quot;WatchListItem&quot;, filmId: film.id, userId: args.userId };</code></p>
<p>If we want other services to consume the Film type we need the __resolveReference method within the type resolver. Within this method the related dataservice method is attached.</p>
<p>After the types and the resolvers are set up correctly the federated service is created:</p>
<pre><code class="hljs language-javascript"><span class="hljs-keyword">const</span> server = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ApolloServer</span>({
  <span class="hljs-attr">dataSources</span>: <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">filmsApi</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">FilmsApi</span>(),
    };
  },
  <span class="hljs-attr">schema</span>: <span class="hljs-title function_">buildFederatedSchema</span>([
    {
      typeDefs,
      resolvers,
    },
  ]),
});
</code></pre>
<h2>Creating the watchlist service</h2>
<p>Because we need the userId within this service we get the userId from the requestHeaders and add it to the context. This ensures it&#x27;s always available within all the resolvers.</p>
<pre><code class="hljs language-javascript"><span class="hljs-keyword">const</span> server = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ApolloServer</span>({
  <span class="hljs-attr">dataSources</span>: <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">watchListApi</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">WatchListApi</span>(),
    };
  },
  <span class="hljs-attr">schema</span>: <span class="hljs-title function_">buildFederatedSchema</span>([{ typeDefs, resolvers }]),
  <span class="hljs-attr">context</span>: <span class="hljs-title function_">async</span> ({ req }) =&gt; {
    <span class="hljs-keyword">const</span> userId = req.<span class="hljs-property">headers</span>.<span class="hljs-property">userid</span>;

    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">userId</span>: userId,
    };
  },
});
</code></pre>
<p>In the typedefs an external reference to type Film is added using the @provides keyword. In the external type we only set the @external id. Note that within the query it&#x27;s possible to also request all the other fields within the Film type.</p>
<pre><code class="hljs language-javascript">  type <span class="hljs-title class_">WatchListItem</span> @<span class="hljs-title function_">key</span>(<span class="hljs-params">fields: <span class="hljs-string">&quot;id&quot;</span></span>) {
    <span class="hljs-attr">id</span>: <span class="hljs-variable constant_">ID</span>!
    <span class="hljs-attr">filmId</span>: <span class="hljs-title class_">String</span>!
    <span class="hljs-attr">film</span>: <span class="hljs-title class_">Film</span> @<span class="hljs-title function_">provides</span>(<span class="hljs-attr">fields</span>: <span class="hljs-string">&quot;id&quot;</span>)
  }

  extend type <span class="hljs-title class_">Film</span> @<span class="hljs-title function_">key</span>(<span class="hljs-params">fields: <span class="hljs-string">&quot;id&quot;</span></span>) {
    <span class="hljs-attr">id</span>: <span class="hljs-variable constant_">ID</span>! @external
  }

  type <span class="hljs-title class_">Query</span> {
    <span class="hljs-attr">watchListItems</span>: [<span class="hljs-title class_">WatchListItem</span>]
  }
</code></pre>
<p>Within the resolvers we specify how the WatchListItem is resolved when it&#x27;s requested from another service. Within the film type we tell the resolver to try to get it from another service by only returning <code>{ __typename: &quot;Film&quot;, id: watchListItem.filmId };</code></p>
<pre><code class="hljs language-javascript"><span class="hljs-keyword">const</span> resolvers = {
  <span class="hljs-title class_">Query</span>: {
    <span class="hljs-attr">watchListItems</span>: <span class="hljs-title function_">async</span> (parentValue, args, { dataSources, userId }) =&gt; {
      <span class="hljs-keyword">return</span> dataSources.<span class="hljs-property">watchListApi</span>.<span class="hljs-title function_">getWatchListItems</span>(userId);
    },
  },
  <span class="hljs-title class_">WatchListItem</span>: {
    <span class="hljs-keyword">async</span> <span class="hljs-title function_">__resolveReference</span>(<span class="hljs-params">{ filmId }, context</span>) {
      <span class="hljs-keyword">return</span> context.<span class="hljs-property">dataSources</span>.<span class="hljs-property">watchListApi</span>.<span class="hljs-title function_">getWatchListItemByFilmId</span>(context.<span class="hljs-property">userId</span>, filmId);
    },
    <span class="hljs-title function_">film</span>(<span class="hljs-params">watchListItem</span>) {
      <span class="hljs-keyword">return</span> { <span class="hljs-attr">__typename</span>: <span class="hljs-string">&quot;Film&quot;</span>, <span class="hljs-attr">id</span>: watchListItem.<span class="hljs-property">filmId</span> };
    },
  },
};
</code></pre>
<p>Now with this setup we can execute queries that will consume both services (see below for some examples). When using the graphql explorer we add the auth token to the http header to get the results we want.
<img src="/blog/getFilms.png" alt="alt text" title="get films"/></p>
<p><img src="/blog/getWatchlistitems.png" alt="alt text" title="get watchlistitems"/></p>
<p>In future blogposts I would like to dive deeper into the apollo-client and optimising the dataservices. Explore the caching options both on the client and on the server.</p>
<p>For now the rest of the source code is available on:
<a href="https://github.com/erwinsmit/watchlist">https://github.com/erwinsmit/watchlist</a></p></div></article></main><section class="bg-gray-800 text-white py-12"><div class="container mx-auto px-4 text-center"><h2 class="text-2xl font-bold mb-6">Connect With Me</h2><div class="flex justify-center space-x-6"><a href="https://github.com/erwinsmit" target="_blank" rel="noopener noreferrer" class="hover:text-blue-400 transition-colors"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-github"><path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"></path><path d="M9 18c-4.51 2-5-2-7-2"></path></svg><span class="sr-only">GitHub</span></a><a href="https://www.linkedin.com/in/erwin-smit-40957840/" target="_blank" rel="noopener noreferrer" class="hover:text-blue-400 transition-colors"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-linkedin"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect width="4" height="12" x="2" y="9"></rect><circle cx="4" cy="4" r="2"></circle></svg><span class="sr-only">LinkedIn</span></a></div></div></section><script src="/_next/static/chunks/webpack-8af1d2e0ff41d756.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"4:\"$Sreact.fragment\"\n5:I[231,[\"231\",\"static/chunks/231-c96e92b4cbbab7e2.js\",\"404\",\"static/chunks/app/blog/page-19199c8b99a973b9.js\"],\"\"]\n6:I[9275,[],\"\"]\n7:I[1343,[],\"\"]\n8:I[5442,[\"231\",\"static/chunks/231-c96e92b4cbbab7e2.js\",\"160\",\"static/chunks/app/not-found-84a7f5eea0d523d6.js\"],\"default\"]\na:I[3120,[],\"OutletBoundary\"]\nc:I[3120,[],\"MetadataBoundary\"]\ne:I[3120,[],\"ViewportBoundary\"]\n10:I[6130,[],\"\"]\n1:HL[\"/_next/static/media/a34f9d1faa5f3315-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n2:HL[\"/_next/static/css/3e1713d87a54c95d.css\",\"style\"]\n3:HL[\"/_next/static/css/3a398bc4ce4edcc7.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"VnRbMKA7kLQQMpUxl1LGx\",\"p\":\"\",\"c\":[\"\",\"blog\",\"getting-started-with-apollo-federation\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"getting-started-with-apollo-federation\",\"d\"],{\"children\":[\"__PAGE__?{\\\"slug\\\":\\\"getting-started-with-apollo-federation\\\"}\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$4\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/3e1713d87a54c95d.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[[\"$\",\"head\",null,{\"children\":[[\"$\",\"link\",null,{\"rel\":\"apple-touch-icon\",\"sizes\":\"180x180\",\"href\":\"/favicon/apple-touch-icon.png\"}],[\"$\",\"link\",null,{\"rel\":\"icon\",\"type\":\"image/png\",\"sizes\":\"32x32\",\"href\":\"/favicon/favicon-32x32.png\"}],[\"$\",\"link\",null,{\"rel\":\"icon\",\"type\":\"image/png\",\"sizes\":\"16x16\",\"href\":\"/favicon/favicon-16x16.png\"}],[\"$\",\"link\",null,{\"rel\":\"manifest\",\"href\":\"/favicon/site.webmanifest\"}],[\"$\",\"link\",null,{\"rel\":\"mask-icon\",\"href\":\"/favicon/safari-pinned-tab.svg\",\"color\":\"#000000\"}],[\"$\",\"link\",null,{\"rel\":\"shortcut icon\",\"href\":\"/favicon/favicon.ico\"}],[\"$\",\"meta\",null,{\"name\":\"msapplication-TileColor\",\"content\":\"#000000\"}],[\"$\",\"meta\",null,{\"name\":\"msapplication-config\",\"content\":\"/favicon/browserconfig.xml\"}],[\"$\",\"meta\",null,{\"name\":\"theme-color\",\"content\":\"#000\"}],[\"$\",\"link\",null,{\"rel\":\"alternate\",\"type\":\"application/rss+xml\",\"href\":\"/feed.xml\"}]]}],[\"$\",\"body\",null,{\"className\":\"bg-gray-100 \",\"children\":[[\"$\",\"header\",null,{\"className\":\"bg-blue-600 text-white shadow-md\",\"children\":[\"$\",\"div\",null,{\"className\":\"container mx-auto px-4 py-6\",\"children\":[\"$\",\"nav\",null,{\"children\":[\"$\",\"ul\",null,{\"className\":\"flex justify-center space-x-6\",\"children\":[[\"$\",\"li\",null,{\"children\":[\"$\",\"$L5\",null,{\"href\":\"/\",\"className\":\"hover:text-blue-200 transition duration-150 ease-in-out\",\"children\":\"About me\"}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"$L5\",null,{\"href\":\"/blog\",\"className\":\"hover:text-blue-200 transition duration-150 ease-in-out\",\"children\":\"Blog\"}]}]]}]}]}]}],[\"$\",\"main\",null,{\"className\":\"min-h-screen\",\"children\":[\"$\",\"$L6\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L7\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[\"$\",\"$L8\",null,{}],\"notFoundStyles\":[]}]}],[\"$\",\"section\",null,{\"className\":\"bg-gray-800 text-white py-12\",\"children\":[\"$\",\"div\",null,{\"className\":\"container mx-auto px-4 text-center\",\"children\":[[\"$\",\"h2\",null,{\"className\":\"text-2xl font-bold mb-6\",\"children\":\"Connect With Me\"}],[\"$\",\"div\",null,{\"className\":\"flex justify-center space-x-6\",\"children\":[[\"$\",\"a\",null,{\"href\":\"https://github.com/erwinsmit\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"className\":\"hover:text-blue-400 transition-colors\",\"children\":[[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":32,\"height\":32,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-github\",\"children\":[[\"$\",\"path\",\"tonef\",{\"d\":\"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4\"}],[\"$\",\"path\",\"9comsn\",{\"d\":\"M9 18c-4.51 2-5-2-7-2\"}],\"$undefined\"]}],[\"$\",\"span\",null,{\"className\":\"sr-only\",\"children\":\"GitHub\"}]]}],[\"$\",\"a\",null,{\"href\":\"https://www.linkedin.com/in/erwin-smit-40957840/\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"className\":\"hover:text-blue-400 transition-colors\",\"children\":[[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":32,\"height\":32,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-linkedin\",\"children\":[[\"$\",\"path\",\"c2jq9f\",{\"d\":\"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z\"}],[\"$\",\"rect\",\"mk3on5\",{\"width\":\"4\",\"height\":\"12\",\"x\":\"2\",\"y\":\"9\"}],[\"$\",\"circle\",\"bt5ra8\",{\"cx\":\"4\",\"cy\":\"4\",\"r\":\"2\"}],\"$undefined\"]}],[\"$\",\"span\",null,{\"className\":\"sr-only\",\"children\":\"LinkedIn\"}]]}]]}]]}]}]]}]]}]]}],{\"children\":[\"blog\",[\"$\",\"$4\",\"c\",{\"children\":[null,[\"$\",\"$L6\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L7\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\"}]]}],{\"children\":[[\"slug\",\"getting-started-with-apollo-federation\",\"d\"],[\"$\",\"$4\",\"c\",{\"children\":[null,[\"$\",\"$L6\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\",\"$0:f:0:1:2:children:2:children:0\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L7\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$4\",\"c\",{\"children\":[\"$L9\",[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/3a398bc4ce4edcc7.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"$La\",null,{\"children\":\"$Lb\"}]]}],{},null]},null]},null]},null],[\"$\",\"$4\",\"h\",{\"children\":[null,[\"$\",\"$4\",\"CsGM-ANAkxp4QYMqsVd5y\",{\"children\":[[\"$\",\"$Lc\",null,{\"children\":\"$Ld\"}],[\"$\",\"$Le\",null,{\"children\":\"$Lf\"}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\"}]]}]]}]]],\"m\":\"$undefined\",\"G\":[\"$10\",\"$undefined\"],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"9:[\"$\",\"article\",null,{\"className\":\"max-w-7xl mx-auto px-8 my-12\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"w-full relative mb-8 text-6xl font-extrabold tracking-normal text-center title-font\",\"children\":[\"$\",\"span\",null,{\"className\":\"bg-clip-text text-transparent bg-gradient-to-b from-blue-600 to-blue-500\",\"children\":\"Exploring the apollo graphql stack\"}]}],[\"$\",\"div\",null,{\"className\":\"flex items-center justify-center mb-16\",\"children\":[\"$\",\"p\",null,{\"className\":\"text-base font-medium text-gray-600 group-hover:text-gray-800\",\"children\":[\"$\",\"time\",null,{\"dateTime\":\"2020-02-15\",\"children\":\"February\\t15, 2020\"}]}]}],[\"$\",\"div\",null,{\"className\":\"prose lg:prose-xl max-w-none prose-pre:p-0\",\"children\":[[\"$\",\"h2\",\"h2-0\",{\"children\":\"Why?\"}],\"\\n\",[\"$\",\"p\",\"p-0\",{\"children\":\"At a project I'm working on we have to build a single page application with authentication that needs to query data from multiple data services.\"}],\"\\n\",[\"$\",\"p\",\"p-1\",{\"children\":\"There are also a lot of examples where we need to 'stitch' these services together. Let's have a look at the domain model and the corresponding services:\"}],\"\\n\",[\"$\",\"p\",\"p-2\",{\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"/blog/spaData.jpg\",\"alt\":\"alt text\",\"title\":\"data setup\"}]}],\"\\n\",[\"$\",\"p\",\"p-3\",{\"children\":\"Note that I'm not really a pro drawing things with draw.io...\\nBut you get the point, if we fetch service requests for example. We also have to get the related entity \u0026 portfolio for every single service request. Currently we do this with separate api calls and it works but it complicates loading states and it makes the frontend application harder to work with.\"}],\"\\n\",[\"$\",\"p\",\"p-4\",{\"children\":\"Would it not be nice to get a list of service requests, without having to create 3 api calls from the frontend? Of course this can all be done on the server, but if the requirements change all needs to be updated. For example, if the business decides it doesn't want entity information on a service request we can remove it from the frontend but the server will still fetch all the data, what a waste! This is where graphql shines, there is a clear connection between the client and the server on the data it actually needs.\"}],\"\\n\",[\"$\",\"p\",\"p-5\",{\"children\":\"Graphql provides a nice query language for querying the date you want with nested objects supported as well.\"}],\"\\n\",[\"$\",\"p\",\"p-6\",{\"children\":\"A query for fetching service requests with the related entities and portfolios would look like this:\"}],\"\\n\",[\"$\",\"pre\",\"pre-0\",{\"children\":[\"$\",\"code\",\"code-0\",{\"className\":\"hljs language-graphql\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"hljs-keyword\",\"children\":\"query\"}],\" getServiceRequests \",[\"$\",\"span\",\"span-1\",{\"className\":\"hljs-punctuation\",\"children\":\"{\"}],\"\\n  ServiceRequests \",[\"$\",\"span\",\"span-2\",{\"className\":\"hljs-punctuation\",\"children\":\"{\"}],\"\\n    entity \",[\"$\",\"span\",\"span-3\",{\"className\":\"hljs-punctuation\",\"children\":\"{\"}],\"\\n      name\\n      address\\n    \",[\"$\",\"span\",\"span-4\",{\"className\":\"hljs-punctuation\",\"children\":\"}\"}],\"\\n    portfolio \",[\"$\",\"span\",\"span-5\",{\"className\":\"hljs-punctuation\",\"children\":\"{\"}],\"\\n      name\\n      address\\n    \",[\"$\",\"span\",\"span-6\",{\"className\":\"hljs-punctuation\",\"children\":\"}\"}],\"\\n    name\\n  \",[\"$\",\"span\",\"span-7\",{\"className\":\"hljs-punctuation\",\"children\":\"}\"}],\"\\n\",[\"$\",\"span\",\"span-8\",{\"className\":\"hljs-punctuation\",\"children\":\"}\"}],\"\\n\"]}]}],\"\\n\",[\"$\",\"p\",\"p-7\",{\"children\":\"This query will return a list with the service requests but with the entity and portfolio objects already embedded, nice!\"}],\"\\n\",[\"$\",\"p\",\"p-8\",{\"children\":[\"To actually perform this query and stitch all the data together we can use \\\"Apollo Federation\\\":\\n\",[\"$\",\"a\",\"a-0\",{\"href\":\"https://www.apollographql.com/docs/apollo-server/federation/introduction/\",\"children\":\"https://www.apollographql.com/docs/apollo-server/federation/introduction/\"}]]}],\"\\n\",[\"$\",\"h2\",\"h2-1\",{\"children\":\"Watchlist sideproject\"}],\"\\n\",[\"$\",\"p\",\"p-9\",{\"children\":\"I decided to have a play with this using a hobby project. This project called \\\"watchlist\\\" allows me to search for films and add them to my watchlist. I would like to expand it with ratings and sharing functionality but that's for later.\"}],\"\\n\",[\"$\",\"p\",\"p-10\",{\"children\":\"I decided on using themoviedb.org as a source for the films and firebase.google.com for saving films to my watchlist.\"}],\"\\n\",[\"$\",\"p\",\"p-11\",{\"children\":\"The watchlist items are saved in firebase in this structure:\"}],\"\\n\",[\"$\",\"p\",\"p-12\",{\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"/blog/firebase.png\",\"alt\":\"alt text\",\"title\":\"data setup\"}]}],\"\\n\",[\"$\",\"p\",\"p-13\",{\"children\":\"Firebase is using a folder structure, userId is used to group all the watchlist items under the correct user. This way I can simply query everything from a specific directory knowing that it's all scoped to the correct user.\"}],\"\\n\",[\"$\",\"p\",\"p-14\",{\"children\":\"Eventually I would like to query films and find out from each film if it's added to watchlist yet.\"}],\"\\n\",[\"$\",\"p\",\"p-15\",{\"children\":\"The other way round I want to query my watchlist and have all the film information embbeded without having to query the filmservice separately.\"}],\"\\n\",[\"$\",\"h2\",\"h2-2\",{\"children\":\"Setting up the apollo gateway\"}],\"\\n\",[\"$\",\"p\",\"p-16\",{\"children\":\"To use Apollo federation you have to create separate services which can be tied together with a \\\"gateway\\\".\"}],\"\\n\",[\"$\",\"p\",\"p-17\",{\"children\":\"The gateway looks like this:\"}],\"\\n\",[\"$\",\"pre\",\"pre-1\",{\"children\":[\"$\",\"code\",\"code-0\",{\"className\":\"hljs language-javascript\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"hljs-keyword\",\"children\":\"const\"}],\" gateway = \",[\"$\",\"span\",\"span-1\",{\"className\":\"hljs-keyword\",\"children\":\"new\"}],\" \",[\"$\",\"span\",\"span-2\",{\"className\":\"hljs-title class_\",\"children\":\"ApolloGateway\"}],\"({\\n  \",[\"$\",\"span\",\"span-3\",{\"className\":\"hljs-attr\",\"children\":\"serviceList\"}],\": [\\n    { \",[\"$\",\"span\",\"span-4\",{\"className\":\"hljs-attr\",\"children\":\"name\"}],\": \",[\"$\",\"span\",\"span-5\",{\"className\":\"hljs-string\",\"children\":\"\\\"watchListItems\\\"\"}],\", \",[\"$\",\"span\",\"span-6\",{\"className\":\"hljs-attr\",\"children\":\"url\"}],\": \",[\"$\",\"span\",\"span-7\",{\"className\":\"hljs-string\",\"children\":\"\\\"http://localhost:5002\\\"\"}],\" },\\n    { \",[\"$\",\"span\",\"span-8\",{\"className\":\"hljs-attr\",\"children\":\"name\"}],\": \",[\"$\",\"span\",\"span-9\",{\"className\":\"hljs-string\",\"children\":\"\\\"films\\\"\"}],\", \",[\"$\",\"span\",\"span-10\",{\"className\":\"hljs-attr\",\"children\":\"url\"}],\": \",[\"$\",\"span\",\"span-11\",{\"className\":\"hljs-string\",\"children\":\"\\\"http://localhost:5003\\\"\"}],\" },\\n  ],\\n  \",[\"$\",\"span\",\"span-12\",{\"className\":\"hljs-title function_\",\"children\":\"buildService\"}],\"(\",[\"$\",\"span\",\"span-13\",{\"className\":\"hljs-params\",\"children\":\"{ name, url }\"}],\") {\\n    \",[\"$\",\"span\",\"span-14\",{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",\"span-15\",{\"className\":\"hljs-keyword\",\"children\":\"new\"}],\" \",[\"$\",\"span\",\"span-16\",{\"className\":\"hljs-title class_\",\"children\":\"AuthenticatedDataSource\"}],\"({ url });\\n  },\\n});\\n\"]}]}],\"\\n\",[\"$\",\"p\",\"p-18\",{\"children\":\"Because I can only return watchlistitems if the user is authenticated I have to pass an Auth token from my frontend application. In the gateway this token is translated into a userId. The userId is placed on the context, context is a mechanism that allows apollo server to add variables to a global scope which can be accessed anywhere within the scope of the request.\"}],\"\\n\",[\"$\",\"pre\",\"pre-2\",{\"children\":[\"$\",\"code\",\"code-0\",{\"className\":\"hljs language-javascript\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"hljs-keyword\",\"children\":\"const\"}],\" server = \",[\"$\",\"span\",\"span-1\",{\"className\":\"hljs-keyword\",\"children\":\"new\"}],\" \",[\"$\",\"span\",\"span-2\",{\"className\":\"hljs-title class_\",\"children\":\"ApolloServer\"}],\"({\\n  gateway,\\n  \",[\"$\",\"span\",\"span-3\",{\"className\":\"hljs-attr\",\"children\":\"context\"}],\": \",[\"$\",\"span\",\"span-4\",{\"className\":\"hljs-title function_\",\"children\":\"async\"}],\" ({ req, context }) =\u003e {\\n    \",[\"$\",\"span\",\"span-5\",{\"className\":\"hljs-keyword\",\"children\":\"const\"}],\" token = req.\",[\"$\",\"span\",\"span-6\",{\"className\":\"hljs-property\",\"children\":\"headers\"}],\".\",[\"$\",\"span\",\"span-7\",{\"className\":\"hljs-property\",\"children\":\"authorization\"}],\" || \",[\"$\",\"span\",\"span-8\",{\"className\":\"hljs-string\",\"children\":\"\\\"\\\"\"}],\";\\n    \",[\"$\",\"span\",\"span-9\",{\"className\":\"hljs-keyword\",\"children\":\"try\"}],\" {\\n      \",[\"$\",\"span\",\"span-10\",{\"className\":\"hljs-keyword\",\"children\":\"const\"}],\" user = \",[\"$\",\"span\",\"span-11\",{\"className\":\"hljs-keyword\",\"children\":\"await\"}],\" firebaseApp.\",[\"$\",\"span\",\"span-12\",{\"className\":\"hljs-title function_\",\"children\":\"auth\"}],\"().\",[\"$\",\"span\",\"span-13\",{\"className\":\"hljs-title function_\",\"children\":\"verifyIdToken\"}],\"(token);\\n      \",[\"$\",\"span\",\"span-14\",{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" {\\n        \",[\"$\",\"span\",\"span-15\",{\"className\":\"hljs-attr\",\"children\":\"userId\"}],\": user.\",[\"$\",\"span\",\"span-16\",{\"className\":\"hljs-property\",\"children\":\"user_id\"}],\",\\n      };\\n    } \",[\"$\",\"span\",\"span-17\",{\"className\":\"hljs-keyword\",\"children\":\"catch\"}],\" (e) {\\n      \",[\"$\",\"span\",\"span-18\",{\"className\":\"hljs-variable language_\",\"children\":\"console\"}],\".\",[\"$\",\"span\",\"span-19\",{\"className\":\"hljs-title function_\",\"children\":\"error\"}],\"(e);\\n      \",[\"$\",\"span\",\"span-20\",{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" {\\n        \",[\"$\",\"span\",\"span-21\",{\"className\":\"hljs-attr\",\"children\":\"userId\"}],\": \",[\"$\",\"span\",\"span-22\",{\"className\":\"hljs-literal\",\"children\":\"undefined\"}],\",\\n      };\\n    }\\n  },\\n  \",[\"$\",\"span\",\"span-23\",{\"className\":\"hljs-attr\",\"children\":\"subscriptions\"}],\": \",[\"$\",\"span\",\"span-24\",{\"className\":\"hljs-literal\",\"children\":\"false\"}],\",\\n});\\n\"]}]}],\"\\n\",[\"$\",\"p\",\"p-19\",{\"children\":\"The context only lives within the 'gateway' not in the underlying services. So after the userId is extracted from the token we pass it through using the http headers.\"}],\"\\n\",[\"$\",\"pre\",\"pre-3\",{\"children\":[\"$\",\"code\",\"code-0\",{\"className\":\"hljs language-javascript\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"hljs-keyword\",\"children\":\"class\"}],\" \",[\"$\",\"span\",\"span-1\",{\"className\":\"hljs-title class_\",\"children\":\"AuthenticatedDataSource\"}],\" \",[\"$\",\"span\",\"span-2\",{\"className\":\"hljs-keyword\",\"children\":\"extends\"}],\" \",[\"$\",\"span\",\"span-3\",{\"className\":\"hljs-title class_ inherited__\",\"children\":\"RemoteGraphQLDataSource\"}],\" {\\n  \",[\"$\",\"span\",\"span-4\",{\"className\":\"hljs-title function_\",\"children\":\"willSendRequest\"}],\"(\",[\"$\",\"span\",\"span-5\",{\"className\":\"hljs-params\",\"children\":\"{ request, context }\"}],\") {\\n    \",[\"$\",\"span\",\"span-6\",{\"className\":\"hljs-keyword\",\"children\":\"if\"}],\" (context.\",[\"$\",\"span\",\"span-7\",{\"className\":\"hljs-property\",\"children\":\"userId\"}],\") {\\n      request.\",[\"$\",\"span\",\"span-8\",{\"className\":\"hljs-property\",\"children\":\"http\"}],\".\",[\"$\",\"span\",\"span-9\",{\"className\":\"hljs-property\",\"children\":\"headers\"}],\".\",[\"$\",\"span\",\"span-10\",{\"className\":\"hljs-title function_\",\"children\":\"set\"}],\"(\",[\"$\",\"span\",\"span-11\",{\"className\":\"hljs-string\",\"children\":\"\\\"userid\\\"\"}],\", context.\",[\"$\",\"span\",\"span-12\",{\"className\":\"hljs-property\",\"children\":\"userId\"}],\");\\n    }\\n  }\\n}\\n\"]}]}],\"\\n\",[\"$\",\"h2\",\"h2-3\",{\"children\":\"Creating the films service\"}],\"\\n\",[\"$\",\"p\",\"p-20\",{\"children\":\"The typedefs for this service are as follows:\"}],\"\\n\",[\"$\",\"pre\",\"pre-4\",{\"children\":[\"$\",\"code\",\"code-0\",{\"className\":\"hljs language-graphql\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"hljs-keyword\",\"children\":\"type\"}],\" Film \",[\"$\",\"span\",\"span-1\",{\"className\":\"hljs-meta\",\"children\":\"@key\"}],[\"$\",\"span\",\"span-2\",{\"className\":\"hljs-punctuation\",\"children\":\"(\"}],[\"$\",\"span\",\"span-3\",{\"className\":\"hljs-symbol\",\"children\":\"fields\"}],[\"$\",\"span\",\"span-4\",{\"className\":\"hljs-punctuation\",\"children\":\":\"}],\" \",[\"$\",\"span\",\"span-5\",{\"className\":\"hljs-string\",\"children\":\"\\\"id\\\"\"}],[\"$\",\"span\",\"span-6\",{\"className\":\"hljs-punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",\"span-7\",{\"className\":\"hljs-punctuation\",\"children\":\"{\"}],\"\\n  \",[\"$\",\"span\",\"span-8\",{\"className\":\"hljs-symbol\",\"children\":\"id\"}],[\"$\",\"span\",\"span-9\",{\"className\":\"hljs-punctuation\",\"children\":\":\"}],\" ID\",[\"$\",\"span\",\"span-10\",{\"className\":\"hljs-punctuation\",\"children\":\"!\"}],\"\\n  \",[\"$\",\"span\",\"span-11\",{\"className\":\"hljs-symbol\",\"children\":\"posterPath\"}],[\"$\",\"span\",\"span-12\",{\"className\":\"hljs-punctuation\",\"children\":\":\"}],\" String\\n  \",[\"$\",\"span\",\"span-13\",{\"className\":\"hljs-symbol\",\"children\":\"title\"}],[\"$\",\"span\",\"span-14\",{\"className\":\"hljs-punctuation\",\"children\":\":\"}],\" String\",[\"$\",\"span\",\"span-15\",{\"className\":\"hljs-punctuation\",\"children\":\"!\"}],\"\\n  \",[\"$\",\"span\",\"span-16\",{\"className\":\"hljs-symbol\",\"children\":\"watchListItem\"}],[\"$\",\"span\",\"span-17\",{\"className\":\"hljs-punctuation\",\"children\":\":\"}],\" WatchListItem \",[\"$\",\"span\",\"span-18\",{\"className\":\"hljs-meta\",\"children\":\"@provides\"}],[\"$\",\"span\",\"span-19\",{\"className\":\"hljs-punctuation\",\"children\":\"(\"}],[\"$\",\"span\",\"span-20\",{\"className\":\"hljs-symbol\",\"children\":\"fields\"}],[\"$\",\"span\",\"span-21\",{\"className\":\"hljs-punctuation\",\"children\":\":\"}],\" \",[\"$\",\"span\",\"span-22\",{\"className\":\"hljs-string\",\"children\":\"\\\"filmId\\\"\"}],[\"$\",\"span\",\"span-23\",{\"className\":\"hljs-punctuation\",\"children\":\")\"}],\"\\n\",[\"$\",\"span\",\"span-24\",{\"className\":\"hljs-punctuation\",\"children\":\"}\"}],\"\\n\\nextend \",[\"$\",\"span\",\"span-25\",{\"className\":\"hljs-keyword\",\"children\":\"type\"}],\" WatchListItem \",[\"$\",\"span\",\"span-26\",{\"className\":\"hljs-meta\",\"children\":\"@key\"}],[\"$\",\"span\",\"span-27\",{\"className\":\"hljs-punctuation\",\"children\":\"(\"}],[\"$\",\"span\",\"span-28\",{\"className\":\"hljs-symbol\",\"children\":\"fields\"}],[\"$\",\"span\",\"span-29\",{\"className\":\"hljs-punctuation\",\"children\":\":\"}],\" \",[\"$\",\"span\",\"span-30\",{\"className\":\"hljs-string\",\"children\":\"\\\"filmId\\\"\"}],[\"$\",\"span\",\"span-31\",{\"className\":\"hljs-punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",\"span-32\",{\"className\":\"hljs-punctuation\",\"children\":\"{\"}],\"\\n  \",[\"$\",\"span\",\"span-33\",{\"className\":\"hljs-symbol\",\"children\":\"filmId\"}],[\"$\",\"span\",\"span-34\",{\"className\":\"hljs-punctuation\",\"children\":\":\"}],\" String\",[\"$\",\"span\",\"span-35\",{\"className\":\"hljs-punctuation\",\"children\":\"!\"}],\" \",[\"$\",\"span\",\"span-36\",{\"className\":\"hljs-meta\",\"children\":\"@external\"}],\"\\n  \",[\"$\",\"span\",\"span-37\",{\"className\":\"hljs-symbol\",\"children\":\"id\"}],[\"$\",\"span\",\"span-38\",{\"className\":\"hljs-punctuation\",\"children\":\":\"}],\" ID\",[\"$\",\"span\",\"span-39\",{\"className\":\"hljs-punctuation\",\"children\":\"!\"}],\" \",[\"$\",\"span\",\"span-40\",{\"className\":\"hljs-meta\",\"children\":\"@external\"}],\"\\n\",[\"$\",\"span\",\"span-41\",{\"className\":\"hljs-punctuation\",\"children\":\"}\"}],\"\\n\\n\",[\"$\",\"span\",\"span-42\",{\"className\":\"hljs-keyword\",\"children\":\"type\"}],\" \",[\"$\",\"span\",\"span-43\",{\"className\":\"hljs-keyword\",\"children\":\"Query\"}],\" \",[\"$\",\"span\",\"span-44\",{\"className\":\"hljs-punctuation\",\"children\":\"{\"}],\"\\n  \",[\"$\",\"span\",\"span-45\",{\"className\":\"hljs-symbol\",\"children\":\"films\"}],[\"$\",\"span\",\"span-46\",{\"className\":\"hljs-punctuation\",\"children\":\":\"}],\" \",[\"$\",\"span\",\"span-47\",{\"className\":\"hljs-punctuation\",\"children\":\"[\"}],\"Film\",[\"$\",\"span\",\"span-48\",{\"className\":\"hljs-punctuation\",\"children\":\"]\"}],\"\\n\",[\"$\",\"span\",\"span-49\",{\"className\":\"hljs-punctuation\",\"children\":\"}\"}],\"\\n\"]}]}],\"\\n\",[\"$\",\"p\",\"p-21\",{\"children\":\"By adding @key(fields: \\\"id\\\") to Film we ensure this type will be able to referenced by other services.\\nIn the Film type there is a reference to WatchListItem, because this will be resolved by other services we add the @provides keyword with the field \\\"filmId\\\" which can be used to resolve the type.\"}],\"\\n\",[\"$\",\"p\",\"p-22\",{\"children\":\"The WatchListItem item lives in another service, so we need to create an extension in this services. That's done by the \\\"extend type\\\" keyword.\"}],\"\\n\",[\"$\",\"p\",\"p-23\",{\"children\":\"Resolvers:\"}],\"\\n\",[\"$\",\"pre\",\"pre-5\",{\"children\":[\"$\",\"code\",\"code-0\",{\"className\":\"hljs language-javascript\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"hljs-keyword\",\"children\":\"const\"}],\" resolvers = {\\n  \",[\"$\",\"span\",\"span-1\",{\"className\":\"hljs-title class_\",\"children\":\"Query\"}],\": {\\n    \",[\"$\",\"span\",\"span-2\",{\"className\":\"hljs-title function_\",\"children\":\"films\"}],\"(\",[\"$\",\"span\",\"span-3\",{\"className\":\"hljs-params\",\"children\":\"parentValue, args, { dataSources }\"}],\") {\\n      \",[\"$\",\"span\",\"span-4\",{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" dataSources.\",[\"$\",\"span\",\"span-5\",{\"className\":\"hljs-property\",\"children\":\"filmsApi\"}],\".\",[\"$\",\"span\",\"span-6\",{\"className\":\"hljs-title function_\",\"children\":\"getTrendingFilms\"}],\"();\\n    },\\n  },\\n  \",[\"$\",\"span\",\"span-7\",{\"className\":\"hljs-title class_\",\"children\":\"Film\"}],\": {\\n    \",[\"$\",\"span\",\"span-8\",{\"className\":\"hljs-title function_\",\"children\":\"__resolveReference\"}],\"(\",[\"$\",\"span\",\"span-9\",{\"className\":\"hljs-params\",\"children\":\"reference, { dataSources }\"}],\") {\\n      \",[\"$\",\"span\",\"span-10\",{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" dataSources.\",[\"$\",\"span\",\"span-11\",{\"className\":\"hljs-property\",\"children\":\"filmsApi\"}],\".\",[\"$\",\"span\",\"span-12\",{\"className\":\"hljs-title function_\",\"children\":\"getFilmById\"}],\"(reference.\",[\"$\",\"span\",\"span-13\",{\"className\":\"hljs-property\",\"children\":\"id\"}],\");\\n    },\\n    \",[\"$\",\"span\",\"span-14\",{\"className\":\"hljs-title function_\",\"children\":\"watchListItem\"}],\"(\",[\"$\",\"span\",\"span-15\",{\"className\":\"hljs-params\",\"children\":\"film, args\"}],\") {\\n      \",[\"$\",\"span\",\"span-16\",{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" { \",[\"$\",\"span\",\"span-17\",{\"className\":\"hljs-attr\",\"children\":\"__typename\"}],\": \",[\"$\",\"span\",\"span-18\",{\"className\":\"hljs-string\",\"children\":\"\\\"WatchListItem\\\"\"}],\", \",[\"$\",\"span\",\"span-19\",{\"className\":\"hljs-attr\",\"children\":\"filmId\"}],\": film.\",[\"$\",\"span\",\"span-20\",{\"className\":\"hljs-property\",\"children\":\"id\"}],\", \",[\"$\",\"span\",\"span-21\",{\"className\":\"hljs-attr\",\"children\":\"userId\"}],\": args.\",[\"$\",\"span\",\"span-22\",{\"className\":\"hljs-property\",\"children\":\"userId\"}],\" };\\n    },\\n  },\\n};\\n\"]}]}],\"\\n\",[\"$\",\"p\",\"p-24\",{\"children\":[\"To resolve the watchListItem type we need to add a resolver that provides the correct fields to the external service. That's done with the this line \",[\"$\",\"code\",\"code-0\",{\"children\":\"return { __typename: \\\"WatchListItem\\\", filmId: film.id, userId: args.userId };\"}]]}],\"\\n\",[\"$\",\"p\",\"p-25\",{\"children\":\"If we want other services to consume the Film type we need the __resolveReference method within the type resolver. Within this method the related dataservice method is attached.\"}],\"\\n\",[\"$\",\"p\",\"p-26\",{\"children\":\"After the types and the resolvers are set up correctly the federated service is created:\"}],\"\\n\",[\"$\",\"pre\",\"pre-6\",{\"children\":[\"$\",\"code\",\"code-0\",{\"className\":\"hljs language-javascript\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"hljs-keyword\",\"children\":\"const\"}],\" server = \",[\"$\",\"span\",\"span-1\",{\"className\":\"hljs-keyword\",\"children\":\"new\"}],\" \",[\"$\",\"span\",\"span-2\",{\"className\":\"hljs-title class_\",\"children\":\"ApolloServer\"}],\"({\\n  \",[\"$\",\"span\",\"span-3\",{\"className\":\"hljs-attr\",\"children\":\"dataSources\"}],\": \",[\"$\",\"span\",\"span-4\",{\"className\":\"hljs-function\",\"children\":\"() =\u003e\"}],\" {\\n    \",[\"$\",\"span\",\"span-5\",{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" {\\n      \",[\"$\",\"span\",\"span-6\",{\"className\":\"hljs-attr\",\"children\":\"filmsApi\"}],\": \",[\"$\",\"span\",\"span-7\",{\"className\":\"hljs-keyword\",\"children\":\"new\"}],\" \",[\"$\",\"span\",\"span-8\",{\"className\":\"hljs-title class_\",\"children\":\"FilmsApi\"}],\"(),\\n    };\\n  },\\n  \",[\"$\",\"span\",\"span-9\",{\"className\":\"hljs-attr\",\"children\":\"schema\"}],\": \",[\"$\",\"span\",\"span-10\",{\"className\":\"hljs-title function_\",\"children\":\"buildFederatedSchema\"}],\"([\\n    {\\n      typeDefs,\\n      resolvers,\\n    },\\n  ]),\\n});\\n\"]}]}],\"\\n\",[\"$\",\"h2\",\"h2-4\",{\"children\":\"Creating the watchlist service\"}],\"\\n\",[\"$\",\"p\",\"p-27\",{\"children\":\"Because we need the userId within this service we get the userId from the requestHeaders and add it to the context. This ensures it's always available within all the resolvers.\"}],\"\\n\",[\"$\",\"pre\",\"pre-7\",{\"children\":[\"$\",\"code\",\"code-0\",{\"className\":\"hljs language-javascript\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"hljs-keyword\",\"children\":\"const\"}],\" server = \",[\"$\",\"span\",\"span-1\",{\"className\":\"hljs-keyword\",\"children\":\"new\"}],\" \",[\"$\",\"span\",\"span-2\",{\"className\":\"hljs-title class_\",\"children\":\"ApolloServer\"}],\"({\\n  \",[\"$\",\"span\",\"span-3\",{\"className\":\"hljs-attr\",\"children\":\"dataSources\"}],\": \",[\"$\",\"span\",\"span-4\",{\"className\":\"hljs-function\",\"children\":\"() =\u003e\"}],\" {\\n    \",[\"$\",\"span\",\"span-5\",{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" {\\n      \",[\"$\",\"span\",\"span-6\",{\"className\":\"hljs-attr\",\"children\":\"watchListApi\"}],\": \",[\"$\",\"span\",\"span-7\",{\"className\":\"hljs-keyword\",\"children\":\"new\"}],\" \",[\"$\",\"span\",\"span-8\",{\"className\":\"hljs-title class_\",\"children\":\"WatchListApi\"}],\"(),\\n    };\\n  },\\n  \",[\"$\",\"span\",\"span-9\",{\"className\":\"hljs-attr\",\"children\":\"schema\"}],\": \",[\"$\",\"span\",\"span-10\",{\"className\":\"hljs-title function_\",\"children\":\"buildFederatedSchema\"}],\"([{ typeDefs, resolvers }]),\\n  \",[\"$\",\"span\",\"span-11\",{\"className\":\"hljs-attr\",\"children\":\"context\"}],\": \",[\"$\",\"span\",\"span-12\",{\"className\":\"hljs-title function_\",\"children\":\"async\"}],\" ({ req }) =\u003e {\\n    \",[\"$\",\"span\",\"span-13\",{\"className\":\"hljs-keyword\",\"children\":\"const\"}],\" userId = req.\",[\"$\",\"span\",\"span-14\",{\"className\":\"hljs-property\",\"children\":\"headers\"}],\".\",[\"$\",\"span\",\"span-15\",{\"className\":\"hljs-property\",\"children\":\"userid\"}],\";\\n\\n    \",[\"$\",\"span\",\"span-16\",{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" {\\n      \",[\"$\",\"span\",\"span-17\",{\"className\":\"hljs-attr\",\"children\":\"userId\"}],\": userId,\\n    };\\n  },\\n});\\n\"]}]}],\"\\n\",[\"$\",\"p\",\"p-28\",{\"children\":\"In the typedefs an external reference to type Film is added using the @provides keyword. In the external type we only set the @external id. Note that within the query it's possible to also request all the other fields within the Film type.\"}],\"\\n\",[\"$\",\"pre\",\"pre-8\",{\"children\":[\"$\",\"code\",\"code-0\",{\"className\":\"hljs language-javascript\",\"children\":[\"  type \",[\"$\",\"span\",\"span-0\",{\"className\":\"hljs-title class_\",\"children\":\"WatchListItem\"}],\" @\",[\"$\",\"span\",\"span-1\",{\"className\":\"hljs-title function_\",\"children\":\"key\"}],\"(\",[\"$\",\"span\",\"span-2\",{\"className\":\"hljs-params\",\"children\":[\"fields: \",[\"$\",\"span\",\"span-0\",{\"className\":\"hljs-string\",\"children\":\"\\\"id\\\"\"}]]}],\") {\\n    \",[\"$\",\"span\",\"span-3\",{\"className\":\"hljs-attr\",\"children\":\"id\"}],\": \",[\"$\",\"span\",\"span-4\",{\"className\":\"hljs-variable constant_\",\"children\":\"ID\"}],\"!\\n    \",[\"$\",\"span\",\"span-5\",{\"className\":\"hljs-attr\",\"children\":\"filmId\"}],\": \",[\"$\",\"span\",\"span-6\",{\"className\":\"hljs-title class_\",\"children\":\"String\"}],\"!\\n    \",[\"$\",\"span\",\"span-7\",{\"className\":\"hljs-attr\",\"children\":\"film\"}],\": \",[\"$\",\"span\",\"span-8\",{\"className\":\"hljs-title class_\",\"children\":\"Film\"}],\" @\",[\"$\",\"span\",\"span-9\",{\"className\":\"hljs-title function_\",\"children\":\"provides\"}],\"(\",[\"$\",\"span\",\"span-10\",{\"className\":\"hljs-attr\",\"children\":\"fields\"}],\": \",[\"$\",\"span\",\"span-11\",{\"className\":\"hljs-string\",\"children\":\"\\\"id\\\"\"}],\")\\n  }\\n\\n  extend type \",[\"$\",\"span\",\"span-12\",{\"className\":\"hljs-title class_\",\"children\":\"Film\"}],\" @\",[\"$\",\"span\",\"span-13\",{\"className\":\"hljs-title function_\",\"children\":\"key\"}],\"(\",[\"$\",\"span\",\"span-14\",{\"className\":\"hljs-params\",\"children\":[\"fields: \",[\"$\",\"span\",\"span-0\",{\"className\":\"hljs-string\",\"children\":\"\\\"id\\\"\"}]]}],\") {\\n    \",[\"$\",\"span\",\"span-15\",{\"className\":\"hljs-attr\",\"children\":\"id\"}],\": \",[\"$\",\"span\",\"span-16\",{\"className\":\"hljs-variable constant_\",\"children\":\"ID\"}],\"! @external\\n  }\\n\\n  type \",[\"$\",\"span\",\"span-17\",{\"className\":\"hljs-title class_\",\"children\":\"Query\"}],\" {\\n    \",[\"$\",\"span\",\"span-18\",{\"className\":\"hljs-attr\",\"children\":\"watchListItems\"}],\": [\",[\"$\",\"span\",\"span-19\",{\"className\":\"hljs-title class_\",\"children\":\"WatchListItem\"}],\"]\\n  }\\n\"]}]}],\"\\n\",[\"$\",\"p\",\"p-29\",{\"children\":[\"Within the resolvers we specify how the WatchListItem is resolved when it's requested from another service. Within the film type we tell the resolver to try to get it from another service by only returning \",[\"$\",\"code\",\"code-0\",{\"children\":\"{ __typename: \\\"Film\\\", id: watchListItem.filmId };\"}]]}],\"\\n\",[\"$\",\"pre\",\"pre-9\",{\"children\":[\"$\",\"code\",\"code-0\",{\"className\":\"hljs language-javascript\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"hljs-keyword\",\"children\":\"const\"}],\" resolvers = {\\n  \",[\"$\",\"span\",\"span-1\",{\"className\":\"hljs-title class_\",\"children\":\"Query\"}],\": {\\n    \",[\"$\",\"span\",\"span-2\",{\"className\":\"hljs-attr\",\"children\":\"watchListItems\"}],\": \",[\"$\",\"span\",\"span-3\",{\"className\":\"hljs-title function_\",\"children\":\"async\"}],\" (parentValue, args, { dataSources, userId }) =\u003e {\\n      \",[\"$\",\"span\",\"span-4\",{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" dataSources.\",[\"$\",\"span\",\"span-5\",{\"className\":\"hljs-property\",\"children\":\"watchListApi\"}],\".\",[\"$\",\"span\",\"span-6\",{\"className\":\"hljs-title function_\",\"children\":\"getWatchListItems\"}],\"(userId);\\n    },\\n  },\\n  \",[\"$\",\"span\",\"span-7\",{\"className\":\"hljs-title class_\",\"children\":\"WatchListItem\"}],\": {\\n    \",[\"$\",\"span\",\"span-8\",{\"className\":\"hljs-keyword\",\"children\":\"async\"}],\" \",[\"$\",\"span\",\"span-9\",{\"className\":\"hljs-title function_\",\"children\":\"__resolveReference\"}],\"(\",[\"$\",\"span\",\"span-10\",{\"className\":\"hljs-params\",\"children\":\"{ filmId }, context\"}],\") {\\n      \",[\"$\",\"span\",\"span-11\",{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" context.\",[\"$\",\"span\",\"span-12\",{\"className\":\"hljs-property\",\"children\":\"dataSources\"}],\".\",[\"$\",\"span\",\"span-13\",{\"className\":\"hljs-property\",\"children\":\"watchListApi\"}],\".\",[\"$\",\"span\",\"span-14\",{\"className\":\"hljs-title function_\",\"children\":\"getWatchListItemByFilmId\"}],\"(context.\",[\"$\",\"span\",\"span-15\",{\"className\":\"hljs-property\",\"children\":\"userId\"}],\", filmId);\\n    },\\n    \",[\"$\",\"span\",\"span-16\",{\"className\":\"hljs-title function_\",\"children\":\"film\"}],\"(\",[\"$\",\"span\",\"span-17\",{\"className\":\"hljs-params\",\"children\":\"watchListItem\"}],\") {\\n      \",[\"$\",\"span\",\"span-18\",{\"className\":\"hljs-keyword\",\"children\":\"return\"}],\" { \",[\"$\",\"span\",\"span-19\",{\"className\":\"hljs-attr\",\"children\":\"__typename\"}],\": \",[\"$\",\"span\",\"span-20\",{\"className\":\"hljs-string\",\"children\":\"\\\"Film\\\"\"}],\", \",[\"$\",\"span\",\"span-21\",{\"className\":\"hljs-attr\",\"children\":\"id\"}],\": watchListItem.\",[\"$\",\"span\",\"span-22\",{\"className\":\"hljs-property\",\"children\":\"filmId\"}],\" };\\n    },\\n  },\\n};\\n\"]}]}],\"\\n\",[\"$\",\"p\",\"p-30\",{\"children\":[\"Now with this setup we can execute queries that will consume both services (see below for some examples). When using the graphql explorer we add the auth token to the http header to get the results we want.\\n\",[\"$\",\"img\",\"img-0\",{\"src\":\"/blog/getFilms.png\",\"alt\":\"alt text\",\"title\":\"get films\"}]]}],\"\\n\",[\"$\",\"p\",\"p-31\",{\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"/blog/getWatchlistitems.png\",\"alt\":\"alt text\",\"title\":\"get watchlistitems\"}]}],\"\\n\",[\"$\",\"p\",\"p-32\",{\"children\":\"In future blogposts I would like to dive deeper into the apollo-client and optimising the dataservices. Explore the caching options both on the client and on the server.\"}],\"\\n\",[\"$\",\"p\",\"p-33\",{\"children\":[\"For now the rest of the source code is available on:\\n\",[\"$\",\"a\",\"a-0\",{\"href\":\"https://github.com/erwinsmit/watchlist\",\"children\":\"https://github.com/erwinsmit/watchlist\"}]]}]]}]]}]\n"])</script><script>self.__next_f.push([1,"f:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n"])</script><script>self.__next_f.push([1,"d:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"1\",{\"children\":\"Exploring the apollo graphql stack\"}],[\"$\",\"meta\",\"2\",{\"name\":\"description\",\"content\":\"Erwin Smit - Freelance frontend developer / fullstack developer\"}],[\"$\",\"meta\",\"3\",{\"property\":\"og:title\",\"content\":\"Exploring the apollo graphql stack\"}],[\"$\",\"meta\",\"4\",{\"property\":\"og:description\",\"content\":\"Erwin Smit - Freelance frontend developer / fullstack developer\"}],[\"$\",\"meta\",\"5\",{\"name\":\"twitter:card\",\"content\":\"summary\"}],[\"$\",\"meta\",\"6\",{\"name\":\"twitter:title\",\"content\":\"Exploring the apollo graphql stack\"}],[\"$\",\"meta\",\"7\",{\"name\":\"twitter:description\",\"content\":\"Erwin Smit - Freelance frontend developer / fullstack developer\"}]]\n"])</script><script>self.__next_f.push([1,"b:null\n"])</script></body></html>