4:"$Sreact.fragment"
5:I[7256,["231","static/chunks/231-015614b9a59ae6eb.js","173","static/chunks/173-e6c8bf506bfb93ff.js","185","static/chunks/app/layout-3b01fe9cc7c9a385.js"],"default"]
6:I[9275,[],""]
7:I[1343,[],""]
8:I[4703,["231","static/chunks/231-015614b9a59ae6eb.js","160","static/chunks/app/not-found-1a8c8bfeca23077d.js"],"default"]
a:I[3120,[],"OutletBoundary"]
c:I[3120,[],"MetadataBoundary"]
e:I[3120,[],"ViewportBoundary"]
10:I[6130,[],""]
1:HL["/_next/static/media/a34f9d1faa5f3315-s.p.woff2","font",{"crossOrigin":"","type":"font/woff2"}]
2:HL["/_next/static/css/0f5f8cc0eb7d6afc.css","style"]
3:HL["/_next/static/css/3a398bc4ce4edcc7.css","style"]
0:{"P":null,"b":"b6G128Hr6tcssX9PY9hf3","p":"","c":["","blog","sitecore-nextjs-without-vercel"],"i":false,"f":[[["",{"children":["blog",{"children":[["slug","sitecore-nextjs-without-vercel","d"],{"children":["__PAGE__?{\"slug\":\"sitecore-nextjs-without-vercel\"}",{}]}]}]},"$undefined","$undefined",true],["",["$","$4","c",{"children":[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/0f5f8cc0eb7d6afc.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]],["$","html",null,{"lang":"en","children":[["$","head",null,{"children":[["$","link",null,{"rel":"apple-touch-icon","sizes":"180x180","href":"/favicon/apple-touch-icon.png"}],["$","link",null,{"rel":"icon","type":"image/png","sizes":"32x32","href":"/favicon/favicon-32x32.png"}],["$","link",null,{"rel":"icon","type":"image/png","sizes":"16x16","href":"/favicon/favicon-16x16.png"}],["$","link",null,{"rel":"manifest","href":"/favicon/site.webmanifest"}],["$","link",null,{"rel":"mask-icon","href":"/favicon/safari-pinned-tab.svg","color":"#000000"}],["$","link",null,{"rel":"shortcut icon","href":"/favicon/favicon.ico"}],["$","meta",null,{"name":"msapplication-TileColor","content":"#000000"}],["$","meta",null,{"name":"msapplication-config","content":"/favicon/browserconfig.xml"}],["$","meta",null,{"name":"theme-color","content":"#000"}],["$","link",null,{"rel":"alternate","type":"application/rss+xml","href":"/feed.xml"}]]}],["$","body",null,{"className":"bg-gray-100 [object Object]","children":[["$","$L5",null,{}],["$","main",null,{"className":"min-h-screen","children":["$","$L6",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L7",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":["$","$L8",null,{}],"notFoundStyles":[]}]}],["$","section",null,{"className":"bg-gray-800 text-white py-12","children":["$","div",null,{"className":"container mx-auto px-4 text-center","children":[["$","h2",null,{"className":"text-2xl font-bold mb-6","id":"connect","children":"Connect With Me"}],["$","div",null,{"className":"flex justify-center space-x-6","children":[["$","a",null,{"href":"https://github.com/erwinsmit","target":"_blank","rel":"noopener noreferrer","className":"hover:text-blue-400 transition-colors","children":[["$","svg",null,{"ref":"$undefined","xmlns":"http://www.w3.org/2000/svg","width":32,"height":32,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-github","children":[["$","path","tonef",{"d":"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"}],["$","path","9comsn",{"d":"M9 18c-4.51 2-5-2-7-2"}],"$undefined"]}],["$","span",null,{"className":"sr-only","children":"GitHub"}]]}],["$","a",null,{"href":"https://www.linkedin.com/in/erwin-smit-40957840/","target":"_blank","rel":"noopener noreferrer","className":"hover:text-blue-400 transition-colors","children":[["$","svg",null,{"ref":"$undefined","xmlns":"http://www.w3.org/2000/svg","width":32,"height":32,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-linkedin","children":[["$","path","c2jq9f",{"d":"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"}],["$","rect","mk3on5",{"width":"4","height":"12","x":"2","y":"9"}],["$","circle","bt5ra8",{"cx":"4","cy":"4","r":"2"}],"$undefined"]}],["$","span",null,{"className":"sr-only","children":"LinkedIn"}]]}]]}]]}]}]]}]]}]]}],{"children":["blog",["$","$4","c",{"children":[null,["$","$L6",null,{"parallelRouterKey":"children","segmentPath":["children","blog","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L7",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined"}]]}],{"children":[["slug","sitecore-nextjs-without-vercel","d"],["$","$4","c",{"children":[null,["$","$L6",null,{"parallelRouterKey":"children","segmentPath":["children","blog","children","$0:f:0:1:2:children:2:children:0","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L7",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined"}]]}],{"children":["__PAGE__",["$","$4","c",{"children":["$L9",[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/3a398bc4ce4edcc7.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]],["$","$La",null,{"children":"$Lb"}]]}],{},null]},null]},null]},null],["$","$4","h",{"children":[null,["$","$4","uu3R48tANxo4M7tJVwKjL",{"children":[["$","$Lc",null,{"children":"$Ld"}],["$","$Le",null,{"children":"$Lf"}],["$","meta",null,{"name":"next-size-adjust"}]]}]]}]]],"m":"$undefined","G":["$10","$undefined"],"s":false,"S":true}
9:["$","article",null,{"className":"max-w-7xl mx-auto px-8 my-12","children":[["$","h1",null,{"className":"w-full relative mb-8 text-6xl font-extrabold tracking-normal text-center title-font","children":["$","span",null,{"className":"bg-clip-text text-transparent bg-gradient-to-b from-blue-600 to-blue-500","children":"Sitecore JSS Next.js without Vercel"}]}],["$","div",null,{"className":"flex items-center justify-center mb-16","children":["$","p",null,{"className":"text-base font-medium text-gray-600 group-hover:text-gray-800","children":["$","time",null,{"dateTime":"2022-10-10","children":"October\t10, 2022"}]}]}],["$","div",null,{"className":"prose lg:prose-xl max-w-none prose-pre:p-0","children":[["$","p","p-0",{"children":["As we all know by now, Vercel is a great platform to host your Next.js apps. I currently use it for some small projects and I love the developer experience.\nIt's so easy to handle deployments, preview pull requests (you get a unique URL for each pull request), real performance monitoring (using ",["$","a","a-0",{"href":"https://web.dev/vitals/","children":"Core Web Vitals"}],"), and much more."]}],"\n",["$","p","p-1",{"children":"But... There are some drawbacks to Vercel."}],"\n",["$","ul","ul-0",{"children":["\n",["$","li","li-0",{"children":["\n",["$","p","p-0",{"children":["Most clients my from my employer ",["$","a","a-0",{"href":"https://www.macaw.nl","children":"Macaw"}]," already pay for a hosting provider, in the Microsoft world, this is Azure. It's hard to also sell Vercel in that case."]}],"\n"]}],"\n",["$","li","li-1",{"children":["\n",["$","p","p-0",{"children":["The pricing is hard to predict, it goes from ",["$","strong","strong-0",{"children":"free"}]," to ",["$","strong","strong-1",{"children":"10 dollars a month"}]," to ",["$","strong","strong-2",{"children":"enterprise"}],". In Azure for example this is more transparent, with the ",["$","a","a-0",{"href":"https://azure.microsoft.com/en-us/pricing/calculator/","children":"cost calculator"}]," you can get a decent estimate."]}],"\n"]}],"\n"]}],"\n",["$","p","p-2",{"children":["$","img","img-0",{"src":"/blog/vercel-pricing.png","alt":"Vercel pricing"}]}],"\n",["$","ul","ul-1",{"children":["\n",["$","li","li-0",{"children":[["$","strong","strong-0",{"children":"GDPR"}]," is especially a hard requirement for German clients. The GDPR is more strict in Germany than in other countries, although Vercel claims to cover GDPR in the EU, it does not seem to make the same amount of effort as Azure with a dedicated ",["$","a","a-0",{"href":"https://azure.microsoft.com/en-us/support/legal/privacy-statement/germany/","children":"German cloud"}],". Disclaimer: Legal stuff is not my strong suit"]}],"\n"]}],"\n",["$","p","p-3",{"children":["I understand that some of these issues are not a problem when you use ",["$","a","a-0",{"href":"https://www.sitecore.com/products/xm-cloud","children":"Sitecore XM Cloud"}],". Sitecore won't be hosted on Azure and Vercel comes as a package with the deal (as I understand). However, that's still in the future and some clients might not want to use XM Cloud because they prefer to host Sitecore themselves."]}],"\n",["$","p","p-4",{"children":"So, it's worth discovering options on how to do all this without the dependency on Vercel.\nWe did just that last year."}],"\n",["$","h2","h2-0",{"children":"Old solution,"}],"\n",["$","p","p-5",{"children":"Last year I've worked on a way of hosting Sitecore Next.js with Azure:"}],"\n",["$","ul","ul-2",{"children":["\n",["$","li","li-0",{"children":["$","a","a-0",{"href":"/blog/nextjs-on-azure-functions/","children":"Next.js on Azure Functions"}]}],"\n",["$","li","li-1",{"children":["$","a","a-0",{"href":"/blog/deploy-azure-functions-github-actions/","children":"Deploy Azure Functions with Github Actions"}]}],"\n",["$","li","li-2",{"children":["$","a","a-0",{"href":"/blog/sitecore-jss-on-azure-functions/","children":"Sitecore JSS on Azure functions"}]}],"\n"]}],"\n",["$","p","p-6",{"children":"This diagram explains how it all works together:"}],"\n",["$","p","p-7",{"children":["$","img","img-0",{"src":"/blog/old-solution.svg","alt":"Old solution"}]}],"\n",["$","p","p-8",{"children":["When I worked on this, Azure Functions version 3 was the latest version. Now it's version 4 and proxies are not ",["$","a","a-0",{"href":"https://learn.microsoft.com/en-us/azure/azure-functions/functions-proxies#legacy-functions-proxies","children":"supported anymore"}],".\nThis December, support for Azure Functions version 3 will be switched off so this solution is not viable anymore."]}],"\n",["$","h2","h2-1",{"children":"A new proxy"}],"\n",["$","p","p-9",{"children":"So we got back to the drawing board and came up with the following solution:"}],"\n",["$","p","p-10",{"children":["$","img","img-0",{"src":"/blog/new-solution.svg","alt":"New solution"}]}],"\n",["$","p","p-11",{"children":["Instead of using Azure Function proxies a .NET application with ",["$","a","a-0",{"href":"https://microsoft.github.io/reverse-proxy/","children":"YARP (Yet another reverse proxy)"}]," is used. What I like about YARP is that you almost need no code at all to get it running.\nAlmost all the proxy rules are configured through the appsettings alone, see: ",["$","a","a-1",{"href":"https://github.com/macaw-cad/nextjs-on-azure/blob/main/YarpProxy/appsettings.Development.json","children":"https://github.com/macaw-cad/nextjs-on-azure/blob/main/YarpProxy/appsettings.Development.json"}],"."]}],"\n",["$","p","p-12",{"children":"Only for the static files from Next.js a couple of lines of code are necessary to mount the file share."}],"\n",["$","pre","pre-0",{"children":["$","code","code-0",{"className":"hljs language-js","children":[["$","span","span-0",{"className":"hljs-keyword","children":"var"}]," nextMount = builder.",["$","span","span-1",{"className":"hljs-property","children":"Configuration"}],".",["$","span","span-2",{"className":"hljs-property","children":"GetValue"}],"<string>(",["$","span","span-3",{"className":"hljs-string","children":"\"NextMount\""}],");\n\napp.",["$","span","span-4",{"className":"hljs-title class_","children":"UseStaticFiles"}],"(",["$","span","span-5",{"className":"hljs-keyword","children":"new"}]," ",["$","span","span-6",{"className":"hljs-title class_","children":"StaticFileOptions"}]," {\n    ",["$","span","span-7",{"className":"hljs-title class_","children":"FileProvider"}]," = ",["$","span","span-8",{"className":"hljs-keyword","children":"new"}]," ",["$","span","span-9",{"className":"hljs-title class_","children":"PhysicalFileProvider"}],"(nextMount),\n    ",["$","span","span-10",{"className":"hljs-title class_","children":"RequestPath"}]," = ",["$","span","span-11",{"className":"hljs-string","children":"\"/_next\""}],"\n});\n"]}]}],"\n",["$","p","p-13",{"children":"That was pretty much it, we were able to re-use the code from the old solution and simply replaced the Azure functions proxy with a different one."}],"\n",["$","p","p-14",{"children":["Just after I wrote this blog post, Azure announced that Azure Static Web Apps will support Next.js with ISR/SSR & API routes soon. See the announcement about ",["$","a","a-0",{"href":"https://techcommunity.microsoft.com/t5/apps-on-azure-blog/extending-next-js-support-in-azure-static-web-apps/ba-p/3627975","children":"Next.js support here"}],"."]}],"\n",["$","p","p-15",{"children":"Will be interesting to see if the Sitecore JSS Next.js SDK will also work with this, perhaps coming up in a blog post soon!"}]]}]]}]
f:[["$","meta","0",{"name":"viewport","content":"width=device-width, initial-scale=1"}]]
d:[["$","meta","0",{"charSet":"utf-8"}],["$","title","1",{"children":"Sitecore JSS Next.js without Vercel"}],["$","meta","2",{"name":"description","content":"Erwin Smit - Freelance frontend developer / fullstack developer"}],["$","meta","3",{"property":"og:title","content":"Sitecore JSS Next.js without Vercel"}],["$","meta","4",{"property":"og:description","content":"Erwin Smit - Freelance frontend developer / fullstack developer"}],["$","meta","5",{"name":"twitter:card","content":"summary"}],["$","meta","6",{"name":"twitter:title","content":"Sitecore JSS Next.js without Vercel"}],["$","meta","7",{"name":"twitter:description","content":"Erwin Smit - Freelance frontend developer / fullstack developer"}]]
b:null
