4:"$Sreact.fragment"
5:I[7256,["231","static/chunks/231-015614b9a59ae6eb.js","173","static/chunks/173-e6c8bf506bfb93ff.js","185","static/chunks/app/layout-28f46ae9c6a8b2dc.js"],"default"]
6:I[9275,[],""]
7:I[1343,[],""]
8:I[4703,["231","static/chunks/231-015614b9a59ae6eb.js","160","static/chunks/app/not-found-081a5836cd82c2ca.js"],"default"]
a:I[3120,[],"OutletBoundary"]
c:I[3120,[],"MetadataBoundary"]
e:I[3120,[],"ViewportBoundary"]
10:I[6130,[],""]
1:HL["/_next/static/media/a34f9d1faa5f3315-s.p.woff2","font",{"crossOrigin":"","type":"font/woff2"}]
2:HL["/_next/static/css/0f5f8cc0eb7d6afc.css","style"]
3:HL["/_next/static/css/3a398bc4ce4edcc7.css","style"]
0:{"P":null,"b":"qbAWKY8PVw4b-TN6TLmIA","p":"","c":["","blog","deploy-azure-functions-github-actions"],"i":false,"f":[[["",{"children":["blog",{"children":[["slug","deploy-azure-functions-github-actions","d"],{"children":["__PAGE__?{\"slug\":\"deploy-azure-functions-github-actions\"}",{}]}]}]},"$undefined","$undefined",true],["",["$","$4","c",{"children":[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/0f5f8cc0eb7d6afc.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]],["$","html",null,{"lang":"en","children":[["$","head",null,{"children":[["$","link",null,{"rel":"apple-touch-icon","sizes":"180x180","href":"/favicon/apple-touch-icon.png"}],["$","link",null,{"rel":"icon","type":"image/png","sizes":"32x32","href":"/favicon/favicon-32x32.png"}],["$","link",null,{"rel":"icon","type":"image/png","sizes":"16x16","href":"/favicon/favicon-16x16.png"}],["$","link",null,{"rel":"manifest","href":"/favicon/site.webmanifest"}],["$","link",null,{"rel":"mask-icon","href":"/favicon/safari-pinned-tab.svg","color":"#000000"}],["$","link",null,{"rel":"shortcut icon","href":"/favicon/favicon.ico"}],["$","meta",null,{"name":"msapplication-TileColor","content":"#000000"}],["$","meta",null,{"name":"msapplication-config","content":"/favicon/browserconfig.xml"}],["$","meta",null,{"name":"theme-color","content":"#000"}],["$","link",null,{"rel":"alternate","type":"application/rss+xml","href":"/feed.xml"}]]}],["$","body",null,{"className":"bg-gray-100 [object Object]","children":[["$","$L5",null,{}],["$","main",null,{"className":"min-h-screen","children":["$","$L6",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L7",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":["$","$L8",null,{}],"notFoundStyles":[]}]}],["$","section",null,{"className":"bg-gray-800 text-white py-12","children":["$","div",null,{"className":"container mx-auto px-4 text-center","children":[["$","h2",null,{"className":"text-2xl font-bold mb-6","id":"connect","children":"Connect With Me"}],["$","div",null,{"className":"flex justify-center space-x-6","children":[["$","a",null,{"href":"https://github.com/erwinsmit","target":"_blank","rel":"noopener noreferrer","className":"hover:text-blue-400 transition-colors","children":[["$","svg",null,{"ref":"$undefined","xmlns":"http://www.w3.org/2000/svg","width":32,"height":32,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-github","children":[["$","path","tonef",{"d":"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"}],["$","path","9comsn",{"d":"M9 18c-4.51 2-5-2-7-2"}],"$undefined"]}],["$","span",null,{"className":"sr-only","children":"GitHub"}]]}],["$","a",null,{"href":"https://www.linkedin.com/in/erwin-smit-40957840/","target":"_blank","rel":"noopener noreferrer","className":"hover:text-blue-400 transition-colors","children":[["$","svg",null,{"ref":"$undefined","xmlns":"http://www.w3.org/2000/svg","width":32,"height":32,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-linkedin","children":[["$","path","c2jq9f",{"d":"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"}],["$","rect","mk3on5",{"width":"4","height":"12","x":"2","y":"9"}],["$","circle","bt5ra8",{"cx":"4","cy":"4","r":"2"}],"$undefined"]}],["$","span",null,{"className":"sr-only","children":"LinkedIn"}]]}]]}]]}]}]]}]]}]]}],{"children":["blog",["$","$4","c",{"children":[null,["$","$L6",null,{"parallelRouterKey":"children","segmentPath":["children","blog","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L7",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined"}]]}],{"children":[["slug","deploy-azure-functions-github-actions","d"],["$","$4","c",{"children":[null,["$","$L6",null,{"parallelRouterKey":"children","segmentPath":["children","blog","children","$0:f:0:1:2:children:2:children:0","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L7",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined"}]]}],{"children":["__PAGE__",["$","$4","c",{"children":["$L9",[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/3a398bc4ce4edcc7.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]],["$","$La",null,{"children":"$Lb"}]]}],{},null]},null]},null]},null],["$","$4","h",{"children":[null,["$","$4","DIfid-irdkLXFluAmiEDs",{"children":[["$","$Lc",null,{"children":"$Ld"}],["$","$Le",null,{"children":"$Lf"}],["$","meta",null,{"name":"next-size-adjust"}]]}]]}]]],"m":"$undefined","G":["$10","$undefined"],"s":false,"S":true}
9:["$","article",null,{"className":"max-w-7xl mx-auto px-8 my-12","children":[["$","h1",null,{"className":"w-full relative mb-8 text-6xl font-extrabold tracking-normal text-center title-font","children":["$","span",null,{"className":"bg-clip-text text-transparent bg-gradient-to-b from-blue-600 to-blue-500","children":"Deploy Azure Functions with GitHub Actions using AzCopy"}]}],["$","div",null,{"className":"flex items-center justify-center mb-16","children":["$","p",null,{"className":"text-base font-medium text-gray-600 group-hover:text-gray-800","children":["$","time",null,{"dateTime":"2021-10-15","children":"October\t15, 2021"}]}]}],["$","div",null,{"className":"prose lg:prose-xl max-w-none prose-pre:p-0","children":[["$","p","p-0",{"children":["When deploying Azure Functions the most straightforward approach is to use the ",["$","strong","strong-0",{"children":"actions/checkout@v2"}]," ",["$","a","a-0",{"href":"https://docs.microsoft.com/en-us/azure/azure-functions/functions-how-to-github-actions","children":"recommended by Azure"}]]}],"\n",["$","p","p-1",{"children":["However, there are some restrictions with this approach. Using this approach. The Azure Functions will only work using the ",["$","strong","strong-0",{"children":["$","a","a-0",{"href":"https://docs.microsoft.com/en-us/azure/azure-functions/run-functions-from-deployment-package","children":"Run from package option"}]}],". There are two reasons why this wasn't great for a ",["$","a","a-0",{"href":"/blog/nextjs-on-azure-functions","children":"Next.js custom server"}],"."]}],"\n",["$","ol","ol-0",{"children":["\n",["$","li","li-0",{"children":["\n",["$","p","p-0",{"children":["Next.js requires to have write access for its ",["$","a","a-0",{"href":"https://nextjs.org/docs/basic-features/data-fetching#incremental-static-regeneration","children":"Incremental Static Generation"}],". With the ",["$","strong","strong-0",{"children":"Run from package option"}]," you can't use this feature."]}],"\n"]}],"\n",["$","li","li-1",{"children":["\n",["$","p","p-0",{"children":["Because there is no write access it's also not possible to use the ",["$","a","a-0",{"href":"https://social.technet.microsoft.com/wiki/contents/articles/36467.understanding-the-azure-app-service-editor.aspx","children":"Azure App Service Editor"}],". During development I love this feature to test changes quickly without having to wait for deployments."]}],"\n"]}],"\n"]}],"\n",["$","h2","h2-0",{"children":"Alternative ways for deploying Azure Function with GitHub Actions"}],"\n",["$","h3","h3-0",{"children":"Using the Azure CLI"}],"\n",["$","p","p-2",{"children":["Instead of using the recommended ",["$","strong","strong-0",{"children":"actions/checkout@v2"}]," it's also possible to use the Azure CLI directly in the .yml file. Before doing so, it's required to run a ",["$","a","a-0",{"href":"https://github.com/marketplace/actions/azure-login","children":"login command"}]," first. To run this you'll need deployment credentials which can be generated through the ",["$","a","a-1",{"href":"https://docs.microsoft.com/en-us/azure/cloud-shell/quickstart","children":"Azure Cloud Shell"}]," for example."]}],"\n",["$","p","p-3",{"children":["If you have the required permissions within your organisation you're in business! Now you can run all the ",["$","a","a-0",{"href":"https://docs.microsoft.com/en-us/cli/azure/functionapp/deployment","children":"deploy commands"}]," available for Azure Functions."]}],"\n",["$","p","p-4",{"children":"I did not have the required permissions to create deployment credentials. Also, when trying to run this locally I found the deployments pretty slow. Just the Azure Functions are deployed quickly but with the Azure Functions also came a big Next.js build folder and their NPM dependencies (with and without remote builds)."}],"\n",["$","h3","h3-1",{"children":"Using AZ Copy"}],"\n",["$","p","p-5",{"children":"This is the solution I picked for deploying Azure Functions. It's reasonably quick for big projects and I have full access to the Azure App Service Editor and write access. Let's show the implementation step by step."}],"\n",["$","ol","ol-1",{"children":["\n",["$","li","li-0",{"children":["\n",["$","p","p-0",{"children":[["$","strong","strong-0",{"children":"Create the Function App"}],"\n",["$","img","img-0",{"src":"/blog/create-function-app.jpg","alt":"Function setup"}]]}],"\n"]}],"\n",["$","li","li-1",{"children":["\n",["$","p","p-0",{"children":[["$","strong","strong-0",{"children":"Select or create a new storage account"}],"\n",["$","img","img-0",{"src":"/blog/storage-account.jpg","alt":"Create storage account"}]]}],"\n"]}],"\n",["$","li","li-2",{"children":["\n",["$","p","p-0",{"children":[["$","strong","strong-0",{"children":"See how the Function App is connected"}],"\n",["$","img","img-0",{"src":"/blog/storage-account-connection.jpg","alt":"Storage account connection"}]]}],"\n"]}],"\n"]}],"\n",["$","p","p-6",{"children":["This helped me to understand how the deployments to Azure Function Apps work. I figured out that all it takes is to upload a set of files to the ",["$","code","code-0",{"children":"wwwroot"}]," folder of the ",["$","code","code-1",{"children":"fileshare"}]," within the storage account."]}],"\n",["$","ol","ol-2",{"start":4,"children":["\n",["$","li","li-0",{"children":[["$","strong","strong-0",{"children":"Set up the GitHub action"}],"\nSee below an example on a yml I use for the deployment of an Azure Function. Place this file in the ",["$","code","code-0",{"children":".github"}]," directory of your project and GitHub will automatically recognise the file and add the Action to the UI."]}],"\n"]}],"\n",["$","p","p-7",{"children":["Personally, I like to use the ",["$","code","code-0",{"children":"workflow_dispatch"}]," event. I don't like to run a full build on each time I push some code."]}],"\n",["$","pre","pre-0",{"children":["$","code","code-0",{"className":"hljs language-yml","children":[["$","span","span-0",{"className":"hljs-attr","children":"name:"}]," ",["$","span","span-1",{"className":"hljs-string","children":"Deploy"}]," ",["$","span","span-2",{"className":"hljs-string","children":"Azure"}]," ",["$","span","span-3",{"className":"hljs-string","children":"Function"}],"\n\n",["$","span","span-4",{"className":"hljs-attr","children":"on:"}]," [",["$","span","span-5",{"className":"hljs-string","children":"workflow_dispatch"}],"]\n\n",["$","span","span-6",{"className":"hljs-attr","children":"env:"}],"\n  ",["$","span","span-7",{"className":"hljs-attr","children":"NODE_VERSION:"}]," ",["$","span","span-8",{"className":"hljs-string","children":"\"14.x\""}],"\n  ",["$","span","span-9",{"className":"hljs-comment","children":"## Enter the path to your storage account and include the name of the file share"}],"\n  ",["$","span","span-10",{"className":"hljs-attr","children":"AZUREFUNCDEST:"}]," ",["$","span","span-11",{"className":"hljs-string","children":"\"https://${pathtostoreageaccount}.file.core.windows.net/${filesharename}/site/wwwroot\""}],"\n\n",["$","span","span-12",{"className":"hljs-attr","children":"jobs:"}],"\n  ",["$","span","span-13",{"className":"hljs-attr","children":"build-and-deploy:"}],"\n    ",["$","span","span-14",{"className":"hljs-attr","children":"runs-on:"}]," ",["$","span","span-15",{"className":"hljs-string","children":"windows-latest"}],"\n    ",["$","span","span-16",{"className":"hljs-attr","children":"steps:"}],"\n      ",["$","span","span-17",{"className":"hljs-bullet","children":"-"}]," ",["$","span","span-18",{"className":"hljs-attr","children":"name:"}]," ",["$","span","span-19",{"className":"hljs-string","children":"\"Checkout GitHub Action\""}],"\n        ",["$","span","span-20",{"className":"hljs-attr","children":"uses:"}]," ",["$","span","span-21",{"className":"hljs-string","children":"actions/checkout@main"}],"\n\n      ",["$","span","span-22",{"className":"hljs-bullet","children":"-"}]," ",["$","span","span-23",{"className":"hljs-attr","children":"name:"}]," ",["$","span","span-24",{"className":"hljs-string","children":"Setup"}]," ",["$","span","span-25",{"className":"hljs-string","children":"Node"}]," ",["$","span","span-26",{"className":"hljs-string","children":"$${{"}]," ",["$","span","span-27",{"className":"hljs-string","children":"env.NODE_VERSION"}]," ",["$","span","span-28",{"className":"hljs-string","children":"}}"}]," ",["$","span","span-29",{"className":"hljs-string","children":"Environment"}],"\n        ",["$","span","span-30",{"className":"hljs-attr","children":"uses:"}]," ",["$","span","span-31",{"className":"hljs-string","children":"actions/setup-node@v1"}],"\n        ",["$","span","span-32",{"className":"hljs-attr","children":"with:"}],"\n          ",["$","span","span-33",{"className":"hljs-attr","children":"node-version:"}]," ",["$","span","span-34",{"className":"hljs-string","children":"$${{"}]," ",["$","span","span-35",{"className":"hljs-string","children":"env.NODE_VERSION"}]," ",["$","span","span-36",{"className":"hljs-string","children":"}}"}],"\n\n      ",["$","span","span-37",{"className":"hljs-comment","children":"## Install a community package that adds the azcopy tool"}],"\n      ",["$","span","span-38",{"className":"hljs-bullet","children":"-"}]," ",["$","span","span-39",{"className":"hljs-attr","children":"name:"}]," ",["$","span","span-40",{"className":"hljs-string","children":"Install"}]," ",["$","span","span-41",{"className":"hljs-string","children":"azcopy"}],"\n        ",["$","span","span-42",{"className":"hljs-attr","children":"uses:"}]," ",["$","span","span-43",{"className":"hljs-string","children":"kheiakiyama/install-azcopy-action@v1.0.3"}],"\n\n      ",["$","span","span-44",{"className":"hljs-comment","children":"## Build your application, replace Lerna with NPM/Yarn if that's more suitable for your project"}],"\n      ",["$","span","span-45",{"className":"hljs-bullet","children":"-"}]," ",["$","span","span-46",{"className":"hljs-attr","children":"name:"}]," ",["$","span","span-47",{"className":"hljs-string","children":"\"Lerna bootstrap & azure functions build\""}],"\n        ",["$","span","span-48",{"className":"hljs-attr","children":"shell:"}]," ",["$","span","span-49",{"className":"hljs-string","children":"pwsh"}],"\n        ",["$","span","span-50",{"className":"hljs-attr","children":"run:"}]," ",["$","span","span-51",{"className":"hljs-string","children":"|\n          lerna bootstrap\n          npm run build\n          popd\n"}],"\n      ",["$","span","span-52",{"className":"hljs-comment","children":"## Clean up the directory before copying the new stuff over"}],"\n      ",["$","span","span-53",{"className":"hljs-bullet","children":"-"}]," ",["$","span","span-54",{"className":"hljs-attr","children":"uses:"}]," ",["$","span","span-55",{"className":"hljs-string","children":"kheiakiyama/install-azcopy-action@v1"}],"\n        ",["$","span","span-56",{"className":"hljs-attr","children":"with:"}],"\n          ",["$","span","span-57",{"className":"hljs-attr","children":"version:"}]," ",["$","span","span-58",{"className":"hljs-string","children":"\"v10\""}],"\n      ",["$","span","span-59",{"className":"hljs-bullet","children":"-"}]," ",["$","span","span-60",{"className":"hljs-attr","children":"run:"}]," ",["$","span","span-61",{"className":"hljs-string","children":"azcopy_v10"}]," ",["$","span","span-62",{"className":"hljs-string","children":"rm"}]," ",["$","span","span-63",{"className":"hljs-string","children":"'${{ env.AZUREFUNCDEST }}?${{ secrets.SECRETSASTOKEN }}'"}]," ",["$","span","span-64",{"className":"hljs-string","children":"--recursive"}],"\n\n      ",["$","span","span-65",{"className":"hljs-comment","children":"## Copy the contents of the azure functions"}],"\n      ",["$","span","span-66",{"className":"hljs-bullet","children":"-"}]," ",["$","span","span-67",{"className":"hljs-attr","children":"uses:"}]," ",["$","span","span-68",{"className":"hljs-string","children":"kheiakiyama/install-azcopy-action@v1"}],"\n        ",["$","span","span-69",{"className":"hljs-attr","children":"with:"}],"\n          ",["$","span","span-70",{"className":"hljs-attr","children":"version:"}]," ",["$","span","span-71",{"className":"hljs-string","children":"\"v10\""}],"\n      ",["$","span","span-72",{"className":"hljs-bullet","children":"-"}]," ",["$","span","span-73",{"className":"hljs-attr","children":"run:"}]," ",["$","span","span-74",{"className":"hljs-string","children":"azcopy_v10"}]," ",["$","span","span-75",{"className":"hljs-string","children":"copy"}]," ",["$","span","span-76",{"className":"hljs-string","children":"'./packages/azure-functions/*'"}]," ",["$","span","span-77",{"className":"hljs-string","children":"'${{ env.AZUREFUNCDEST }}?${{ secrets.SECRETSASTOKEN }}'"}]," ",["$","span","span-78",{"className":"hljs-string","children":"--recursive"}],"\n"]}]}],"\n",["$","p","p-8",{"children":["To authenticate the copying of the files, generate a SAS Token on the storage account.\n",["$","img","img-0",{"src":"/blog/sas-token.jpg","alt":"Generate SAS token"}]]}],"\n",["$","p","p-9",{"children":["Add the SAS Token to the GitHub secrets:\n",["$","img","img-0",{"src":"/blog/github-secret.jpg","alt":"GitHub secret"}]]}],"\n",["$","p","p-10",{"children":"There you go, now you can run the GitHub action and your Azure Function will be deployed. Hopefully, this could be a useful alternative for deploying Azure Functions using GitHub Actions!"}]]}]]}]
f:[["$","meta","0",{"name":"viewport","content":"width=device-width, initial-scale=1"}]]
d:[["$","meta","0",{"charSet":"utf-8"}],["$","title","1",{"children":"Deploy Azure Functions with GitHub Actions using AzCopy"}],["$","meta","2",{"name":"description","content":"Erwin Smit - Freelance frontend developer / fullstack developer"}],["$","meta","3",{"property":"og:title","content":"Deploy Azure Functions with GitHub Actions using AzCopy"}],["$","meta","4",{"property":"og:description","content":"Erwin Smit - Freelance frontend developer / fullstack developer"}],["$","meta","5",{"name":"twitter:card","content":"summary"}],["$","meta","6",{"name":"twitter:title","content":"Deploy Azure Functions with GitHub Actions using AzCopy"}],["$","meta","7",{"name":"twitter:description","content":"Erwin Smit - Freelance frontend developer / fullstack developer"}]]
b:null
