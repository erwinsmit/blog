<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/a34f9d1faa5f3315-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" as="image" href="/blog/vercel-pricing.png"/><link rel="preload" as="image" href="/blog/old-solution.svg"/><link rel="preload" as="image" href="/blog/new-solution.svg"/><link rel="stylesheet" href="/_next/static/css/3e1713d87a54c95d.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/3a398bc4ce4edcc7.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-8af1d2e0ff41d756.js"/><script src="/_next/static/chunks/4bd1b696-23516f99b565b560.js" async=""></script><script src="/_next/static/chunks/215-caa2c8b8fefad047.js" async=""></script><script src="/_next/static/chunks/main-app-8359a3fe9e3783b5.js" async=""></script><script src="/_next/static/chunks/231-c96e92b4cbbab7e2.js" async=""></script><script src="/_next/static/chunks/app/blog/page-19199c8b99a973b9.js" async=""></script><script src="/_next/static/chunks/app/not-found-84a7f5eea0d523d6.js" async=""></script><meta name="next-size-adjust"/><link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png"/><link rel="manifest" href="/favicon/site.webmanifest"/><link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" color="#000000"/><link rel="shortcut icon" href="/favicon/favicon.ico"/><meta name="msapplication-TileColor" content="#000000"/><meta name="msapplication-config" content="/favicon/browserconfig.xml"/><meta name="theme-color" content="#000"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><title>Sitecore JSS Next.js without Vercel</title><meta name="description" content="Erwin Smit - Freelance frontend developer / fullstack developer"/><meta property="og:title" content="Sitecore JSS Next.js without Vercel"/><meta property="og:description" content="Erwin Smit - Freelance frontend developer / fullstack developer"/><meta name="twitter:card" content="summary"/><meta name="twitter:title" content="Sitecore JSS Next.js without Vercel"/><meta name="twitter:description" content="Erwin Smit - Freelance frontend developer / fullstack developer"/><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="bg-gray-100 "><header class="bg-blue-600 text-white shadow-md"><div class="container mx-auto px-4 py-6"><nav><ul class="flex justify-center space-x-6"><li><a class="hover:text-blue-200 transition duration-150 ease-in-out" href="/">About me</a></li><li><a class="hover:text-blue-200 transition duration-150 ease-in-out" href="/blog">Blog</a></li></ul></nav></div></header><main class="min-h-screen"><article class="max-w-7xl mx-auto px-8 my-12"><h1 class="w-full relative mb-8 text-6xl font-extrabold tracking-normal text-center title-font"><span class="bg-clip-text text-transparent bg-gradient-to-b from-blue-600 to-blue-500">Sitecore JSS Next.js without Vercel</span></h1><div class="flex items-center justify-center mb-16"><p class="text-base font-medium text-gray-600 group-hover:text-gray-800"><time dateTime="2022-10-10">October	10, 2022</time></p></div><div class="prose lg:prose-xl max-w-none prose-pre:p-0"><p>As we all know by now, Vercel is a great platform to host your Next.js apps. I currently use it for some small projects and I love the developer experience.
It&#x27;s so easy to handle deployments, preview pull requests (you get a unique URL for each pull request), real performance monitoring (using <a href="https://web.dev/vitals/">Core Web Vitals</a>), and much more.</p>
<p>But... There are some drawbacks to Vercel.</p>
<ul>
<li>
<p>Most clients my from my employer <a href="https://www.macaw.nl">Macaw</a> already pay for a hosting provider, in the Microsoft world, this is Azure. It&#x27;s hard to also sell Vercel in that case.</p>
</li>
<li>
<p>The pricing is hard to predict, it goes from <strong>free</strong> to <strong>10 dollars a month</strong> to <strong>enterprise</strong>. In Azure for example this is more transparent, with the <a href="https://azure.microsoft.com/en-us/pricing/calculator/">cost calculator</a> you can get a decent estimate.</p>
</li>
</ul>
<p><img src="/blog/vercel-pricing.png" alt="Vercel pricing"/></p>
<ul>
<li><strong>GDPR</strong> is especially a hard requirement for German clients. The GDPR is more strict in Germany than in other countries, although Vercel claims to cover GDPR in the EU, it does not seem to make the same amount of effort as Azure with a dedicated <a href="https://azure.microsoft.com/en-us/support/legal/privacy-statement/germany/">German cloud</a>. Disclaimer: Legal stuff is not my strong suit</li>
</ul>
<p>I understand that some of these issues are not a problem when you use <a href="https://www.sitecore.com/products/xm-cloud">Sitecore XM Cloud</a>. Sitecore won&#x27;t be hosted on Azure and Vercel comes as a package with the deal (as I understand). However, that&#x27;s still in the future and some clients might not want to use XM Cloud because they prefer to host Sitecore themselves.</p>
<p>So, it&#x27;s worth discovering options on how to do all this without the dependency on Vercel.
We did just that last year.</p>
<h2>Old solution,</h2>
<p>Last year I&#x27;ve worked on a way of hosting Sitecore Next.js with Azure:</p>
<ul>
<li><a href="/nextjs-on-azure-functions/">Next.js on Azure Functions</a></li>
<li><a href="/deploy-azure-functions-github-actions/">Deploy Azure Functions with Github Actions</a></li>
<li><a href="/sitecore-jss-on-azure-functions/">Sitecore JSS on Azure functions</a></li>
</ul>
<p>This diagram explains how it all works together:</p>
<p><img src="/blog/old-solution.svg" alt="Old solution"/></p>
<p>When I worked on this, Azure Functions version 3 was the latest version. Now it&#x27;s version 4 and proxies are not <a href="https://learn.microsoft.com/en-us/azure/azure-functions/functions-proxies#legacy-functions-proxies">supported anymore</a>.
This December, support for Azure Functions version 3 will be switched off so this solution is not viable anymore.</p>
<h2>A new proxy</h2>
<p>So we got back to the drawing board and came up with the following solution:</p>
<p><img src="/blog/new-solution.svg" alt="New solution"/></p>
<p>Instead of using Azure Function proxies a .NET application with <a href="https://microsoft.github.io/reverse-proxy/">YARP (Yet another reverse proxy)</a> is used. What I like about YARP is that you almost need no code at all to get it running.
Almost all the proxy rules are configured through the appsettings alone, see: <a href="https://github.com/macaw-cad/nextjs-on-azure/blob/main/YarpProxy/appsettings.Development.json">https://github.com/macaw-cad/nextjs-on-azure/blob/main/YarpProxy/appsettings.Development.json</a>.</p>
<p>Only for the static files from Next.js a couple of lines of code are necessary to mount the file share.</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">var</span> nextMount = builder.<span class="hljs-property">Configuration</span>.<span class="hljs-property">GetValue</span>&lt;string&gt;(<span class="hljs-string">&quot;NextMount&quot;</span>);

app.<span class="hljs-title class_">UseStaticFiles</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">StaticFileOptions</span> {
    <span class="hljs-title class_">FileProvider</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PhysicalFileProvider</span>(nextMount),
    <span class="hljs-title class_">RequestPath</span> = <span class="hljs-string">&quot;/_next&quot;</span>
});
</code></pre>
<p>That was pretty much it, we were able to re-use the code from the old solution and simply replaced the Azure functions proxy with a different one.</p>
<p>Just after I wrote this blog post, Azure announced that Azure Static Web Apps will support Next.js with ISR/SSR &amp; API routes soon. See the announcement about <a href="https://techcommunity.microsoft.com/t5/apps-on-azure-blog/extending-next-js-support-in-azure-static-web-apps/ba-p/3627975">Next.js support here</a>.</p>
<p>Will be interesting to see if the Sitecore JSS Next.js SDK will also work with this, perhaps coming up in a blog post soon!</p></div></article></main><section class="bg-gray-800 text-white py-12"><div class="container mx-auto px-4 text-center"><h2 class="text-2xl font-bold mb-6">Connect With Me</h2><div class="flex justify-center space-x-6"><a href="https://github.com/erwinsmit" target="_blank" rel="noopener noreferrer" class="hover:text-blue-400 transition-colors"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-github"><path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"></path><path d="M9 18c-4.51 2-5-2-7-2"></path></svg><span class="sr-only">GitHub</span></a><a href="https://www.linkedin.com/in/erwin-smit-40957840/" target="_blank" rel="noopener noreferrer" class="hover:text-blue-400 transition-colors"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-linkedin"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect width="4" height="12" x="2" y="9"></rect><circle cx="4" cy="4" r="2"></circle></svg><span class="sr-only">LinkedIn</span></a></div></div></section><script src="/_next/static/chunks/webpack-8af1d2e0ff41d756.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"4:\"$Sreact.fragment\"\n5:I[231,[\"231\",\"static/chunks/231-c96e92b4cbbab7e2.js\",\"404\",\"static/chunks/app/blog/page-19199c8b99a973b9.js\"],\"\"]\n6:I[9275,[],\"\"]\n7:I[1343,[],\"\"]\n8:I[5442,[\"231\",\"static/chunks/231-c96e92b4cbbab7e2.js\",\"160\",\"static/chunks/app/not-found-84a7f5eea0d523d6.js\"],\"default\"]\na:I[3120,[],\"OutletBoundary\"]\nc:I[3120,[],\"MetadataBoundary\"]\ne:I[3120,[],\"ViewportBoundary\"]\n10:I[6130,[],\"\"]\n1:HL[\"/_next/static/media/a34f9d1faa5f3315-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n2:HL[\"/_next/static/css/3e1713d87a54c95d.css\",\"style\"]\n3:HL[\"/_next/static/css/3a398bc4ce4edcc7.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"VnRbMKA7kLQQMpUxl1LGx\",\"p\":\"\",\"c\":[\"\",\"blog\",\"sitecore-nextjs-without-vercel\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"sitecore-nextjs-without-vercel\",\"d\"],{\"children\":[\"__PAGE__?{\\\"slug\\\":\\\"sitecore-nextjs-without-vercel\\\"}\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$4\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/3e1713d87a54c95d.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[[\"$\",\"head\",null,{\"children\":[[\"$\",\"link\",null,{\"rel\":\"apple-touch-icon\",\"sizes\":\"180x180\",\"href\":\"/favicon/apple-touch-icon.png\"}],[\"$\",\"link\",null,{\"rel\":\"icon\",\"type\":\"image/png\",\"sizes\":\"32x32\",\"href\":\"/favicon/favicon-32x32.png\"}],[\"$\",\"link\",null,{\"rel\":\"icon\",\"type\":\"image/png\",\"sizes\":\"16x16\",\"href\":\"/favicon/favicon-16x16.png\"}],[\"$\",\"link\",null,{\"rel\":\"manifest\",\"href\":\"/favicon/site.webmanifest\"}],[\"$\",\"link\",null,{\"rel\":\"mask-icon\",\"href\":\"/favicon/safari-pinned-tab.svg\",\"color\":\"#000000\"}],[\"$\",\"link\",null,{\"rel\":\"shortcut icon\",\"href\":\"/favicon/favicon.ico\"}],[\"$\",\"meta\",null,{\"name\":\"msapplication-TileColor\",\"content\":\"#000000\"}],[\"$\",\"meta\",null,{\"name\":\"msapplication-config\",\"content\":\"/favicon/browserconfig.xml\"}],[\"$\",\"meta\",null,{\"name\":\"theme-color\",\"content\":\"#000\"}],[\"$\",\"link\",null,{\"rel\":\"alternate\",\"type\":\"application/rss+xml\",\"href\":\"/feed.xml\"}]]}],[\"$\",\"body\",null,{\"className\":\"bg-gray-100 \",\"children\":[[\"$\",\"header\",null,{\"className\":\"bg-blue-600 text-white shadow-md\",\"children\":[\"$\",\"div\",null,{\"className\":\"container mx-auto px-4 py-6\",\"children\":[\"$\",\"nav\",null,{\"children\":[\"$\",\"ul\",null,{\"className\":\"flex justify-center space-x-6\",\"children\":[[\"$\",\"li\",null,{\"children\":[\"$\",\"$L5\",null,{\"href\":\"/\",\"className\":\"hover:text-blue-200 transition duration-150 ease-in-out\",\"children\":\"About me\"}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"$L5\",null,{\"href\":\"/blog\",\"className\":\"hover:text-blue-200 transition duration-150 ease-in-out\",\"children\":\"Blog\"}]}]]}]}]}]}],[\"$\",\"main\",null,{\"className\":\"min-h-screen\",\"children\":[\"$\",\"$L6\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L7\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[\"$\",\"$L8\",null,{}],\"notFoundStyles\":[]}]}],[\"$\",\"section\",null,{\"className\":\"bg-gray-800 text-white py-12\",\"children\":[\"$\",\"div\",null,{\"className\":\"container mx-auto px-4 text-center\",\"children\":[[\"$\",\"h2\",null,{\"className\":\"text-2xl font-bold mb-6\",\"children\":\"Connect With Me\"}],[\"$\",\"div\",null,{\"className\":\"flex justify-center space-x-6\",\"children\":[[\"$\",\"a\",null,{\"href\":\"https://github.com/erwinsmit\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"className\":\"hover:text-blue-400 transition-colors\",\"children\":[[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":32,\"height\":32,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-github\",\"children\":[[\"$\",\"path\",\"tonef\",{\"d\":\"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4\"}],[\"$\",\"path\",\"9comsn\",{\"d\":\"M9 18c-4.51 2-5-2-7-2\"}],\"$undefined\"]}],[\"$\",\"span\",null,{\"className\":\"sr-only\",\"children\":\"GitHub\"}]]}],[\"$\",\"a\",null,{\"href\":\"https://www.linkedin.com/in/erwin-smit-40957840/\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"className\":\"hover:text-blue-400 transition-colors\",\"children\":[[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":32,\"height\":32,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-linkedin\",\"children\":[[\"$\",\"path\",\"c2jq9f\",{\"d\":\"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z\"}],[\"$\",\"rect\",\"mk3on5\",{\"width\":\"4\",\"height\":\"12\",\"x\":\"2\",\"y\":\"9\"}],[\"$\",\"circle\",\"bt5ra8\",{\"cx\":\"4\",\"cy\":\"4\",\"r\":\"2\"}],\"$undefined\"]}],[\"$\",\"span\",null,{\"className\":\"sr-only\",\"children\":\"LinkedIn\"}]]}]]}]]}]}]]}]]}]]}],{\"children\":[\"blog\",[\"$\",\"$4\",\"c\",{\"children\":[null,[\"$\",\"$L6\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L7\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\"}]]}],{\"children\":[[\"slug\",\"sitecore-nextjs-without-vercel\",\"d\"],[\"$\",\"$4\",\"c\",{\"children\":[null,[\"$\",\"$L6\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\",\"$0:f:0:1:2:children:2:children:0\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L7\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$4\",\"c\",{\"children\":[\"$L9\",[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/3a398bc4ce4edcc7.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"$La\",null,{\"children\":\"$Lb\"}]]}],{},null]},null]},null]},null],[\"$\",\"$4\",\"h\",{\"children\":[null,[\"$\",\"$4\",\"OL18ADNnUaUCB3IVKtNir\",{\"children\":[[\"$\",\"$Lc\",null,{\"children\":\"$Ld\"}],[\"$\",\"$Le\",null,{\"children\":\"$Lf\"}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\"}]]}]]}]]],\"m\":\"$undefined\",\"G\":[\"$10\",\"$undefined\"],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"9:[\"$\",\"article\",null,{\"className\":\"max-w-7xl mx-auto px-8 my-12\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"w-full relative mb-8 text-6xl font-extrabold tracking-normal text-center title-font\",\"children\":[\"$\",\"span\",null,{\"className\":\"bg-clip-text text-transparent bg-gradient-to-b from-blue-600 to-blue-500\",\"children\":\"Sitecore JSS Next.js without Vercel\"}]}],[\"$\",\"div\",null,{\"className\":\"flex items-center justify-center mb-16\",\"children\":[\"$\",\"p\",null,{\"className\":\"text-base font-medium text-gray-600 group-hover:text-gray-800\",\"children\":[\"$\",\"time\",null,{\"dateTime\":\"2022-10-10\",\"children\":\"October\\t10, 2022\"}]}]}],[\"$\",\"div\",null,{\"className\":\"prose lg:prose-xl max-w-none prose-pre:p-0\",\"children\":[[\"$\",\"p\",\"p-0\",{\"children\":[\"As we all know by now, Vercel is a great platform to host your Next.js apps. I currently use it for some small projects and I love the developer experience.\\nIt's so easy to handle deployments, preview pull requests (you get a unique URL for each pull request), real performance monitoring (using \",[\"$\",\"a\",\"a-0\",{\"href\":\"https://web.dev/vitals/\",\"children\":\"Core Web Vitals\"}],\"), and much more.\"]}],\"\\n\",[\"$\",\"p\",\"p-1\",{\"children\":\"But... There are some drawbacks to Vercel.\"}],\"\\n\",[\"$\",\"ul\",\"ul-0\",{\"children\":[\"\\n\",[\"$\",\"li\",\"li-0\",{\"children\":[\"\\n\",[\"$\",\"p\",\"p-0\",{\"children\":[\"Most clients my from my employer \",[\"$\",\"a\",\"a-0\",{\"href\":\"https://www.macaw.nl\",\"children\":\"Macaw\"}],\" already pay for a hosting provider, in the Microsoft world, this is Azure. It's hard to also sell Vercel in that case.\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",\"li-1\",{\"children\":[\"\\n\",[\"$\",\"p\",\"p-0\",{\"children\":[\"The pricing is hard to predict, it goes from \",[\"$\",\"strong\",\"strong-0\",{\"children\":\"free\"}],\" to \",[\"$\",\"strong\",\"strong-1\",{\"children\":\"10 dollars a month\"}],\" to \",[\"$\",\"strong\",\"strong-2\",{\"children\":\"enterprise\"}],\". In Azure for example this is more transparent, with the \",[\"$\",\"a\",\"a-0\",{\"href\":\"https://azure.microsoft.com/en-us/pricing/calculator/\",\"children\":\"cost calculator\"}],\" you can get a decent estimate.\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",\"p-2\",{\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"/blog/vercel-pricing.png\",\"alt\":\"Vercel pricing\"}]}],\"\\n\",[\"$\",\"ul\",\"ul-1\",{\"children\":[\"\\n\",[\"$\",\"li\",\"li-0\",{\"children\":[[\"$\",\"strong\",\"strong-0\",{\"children\":\"GDPR\"}],\" is especially a hard requirement for German clients. The GDPR is more strict in Germany than in other countries, although Vercel claims to cover GDPR in the EU, it does not seem to make the same amount of effort as Azure with a dedicated \",[\"$\",\"a\",\"a-0\",{\"href\":\"https://azure.microsoft.com/en-us/support/legal/privacy-statement/germany/\",\"children\":\"German cloud\"}],\". Disclaimer: Legal stuff is not my strong suit\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",\"p-3\",{\"children\":[\"I understand that some of these issues are not a problem when you use \",[\"$\",\"a\",\"a-0\",{\"href\":\"https://www.sitecore.com/products/xm-cloud\",\"children\":\"Sitecore XM Cloud\"}],\". Sitecore won't be hosted on Azure and Vercel comes as a package with the deal (as I understand). However, that's still in the future and some clients might not want to use XM Cloud because they prefer to host Sitecore themselves.\"]}],\"\\n\",[\"$\",\"p\",\"p-4\",{\"children\":\"So, it's worth discovering options on how to do all this without the dependency on Vercel.\\nWe did just that last year.\"}],\"\\n\",[\"$\",\"h2\",\"h2-0\",{\"children\":\"Old solution,\"}],\"\\n\",[\"$\",\"p\",\"p-5\",{\"children\":\"Last year I've worked on a way of hosting Sitecore Next.js with Azure:\"}],\"\\n\",[\"$\",\"ul\",\"ul-2\",{\"children\":[\"\\n\",[\"$\",\"li\",\"li-0\",{\"children\":[\"$\",\"a\",\"a-0\",{\"href\":\"/nextjs-on-azure-functions/\",\"children\":\"Next.js on Azure Functions\"}]}],\"\\n\",[\"$\",\"li\",\"li-1\",{\"children\":[\"$\",\"a\",\"a-0\",{\"href\":\"/deploy-azure-functions-github-actions/\",\"children\":\"Deploy Azure Functions with Github Actions\"}]}],\"\\n\",[\"$\",\"li\",\"li-2\",{\"children\":[\"$\",\"a\",\"a-0\",{\"href\":\"/sitecore-jss-on-azure-functions/\",\"children\":\"Sitecore JSS on Azure functions\"}]}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",\"p-6\",{\"children\":\"This diagram explains how it all works together:\"}],\"\\n\",[\"$\",\"p\",\"p-7\",{\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"/blog/old-solution.svg\",\"alt\":\"Old solution\"}]}],\"\\n\",[\"$\",\"p\",\"p-8\",{\"children\":[\"When I worked on this, Azure Functions version 3 was the latest version. Now it's version 4 and proxies are not \",[\"$\",\"a\",\"a-0\",{\"href\":\"https://learn.microsoft.com/en-us/azure/azure-functions/functions-proxies#legacy-functions-proxies\",\"children\":\"supported anymore\"}],\".\\nThis December, support for Azure Functions version 3 will be switched off so this solution is not viable anymore.\"]}],\"\\n\",[\"$\",\"h2\",\"h2-1\",{\"children\":\"A new proxy\"}],\"\\n\",[\"$\",\"p\",\"p-9\",{\"children\":\"So we got back to the drawing board and came up with the following solution:\"}],\"\\n\",[\"$\",\"p\",\"p-10\",{\"children\":[\"$\",\"img\",\"img-0\",{\"src\":\"/blog/new-solution.svg\",\"alt\":\"New solution\"}]}],\"\\n\",[\"$\",\"p\",\"p-11\",{\"children\":[\"Instead of using Azure Function proxies a .NET application with \",[\"$\",\"a\",\"a-0\",{\"href\":\"https://microsoft.github.io/reverse-proxy/\",\"children\":\"YARP (Yet another reverse proxy)\"}],\" is used. What I like about YARP is that you almost need no code at all to get it running.\\nAlmost all the proxy rules are configured through the appsettings alone, see: \",[\"$\",\"a\",\"a-1\",{\"href\":\"https://github.com/macaw-cad/nextjs-on-azure/blob/main/YarpProxy/appsettings.Development.json\",\"children\":\"https://github.com/macaw-cad/nextjs-on-azure/blob/main/YarpProxy/appsettings.Development.json\"}],\".\"]}],\"\\n\",[\"$\",\"p\",\"p-12\",{\"children\":\"Only for the static files from Next.js a couple of lines of code are necessary to mount the file share.\"}],\"\\n\",[\"$\",\"pre\",\"pre-0\",{\"children\":[\"$\",\"code\",\"code-0\",{\"className\":\"hljs language-js\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"hljs-keyword\",\"children\":\"var\"}],\" nextMount = builder.\",[\"$\",\"span\",\"span-1\",{\"className\":\"hljs-property\",\"children\":\"Configuration\"}],\".\",[\"$\",\"span\",\"span-2\",{\"className\":\"hljs-property\",\"children\":\"GetValue\"}],\"\u003cstring\u003e(\",[\"$\",\"span\",\"span-3\",{\"className\":\"hljs-string\",\"children\":\"\\\"NextMount\\\"\"}],\");\\n\\napp.\",[\"$\",\"span\",\"span-4\",{\"className\":\"hljs-title class_\",\"children\":\"UseStaticFiles\"}],\"(\",[\"$\",\"span\",\"span-5\",{\"className\":\"hljs-keyword\",\"children\":\"new\"}],\" \",[\"$\",\"span\",\"span-6\",{\"className\":\"hljs-title class_\",\"children\":\"StaticFileOptions\"}],\" {\\n    \",[\"$\",\"span\",\"span-7\",{\"className\":\"hljs-title class_\",\"children\":\"FileProvider\"}],\" = \",[\"$\",\"span\",\"span-8\",{\"className\":\"hljs-keyword\",\"children\":\"new\"}],\" \",[\"$\",\"span\",\"span-9\",{\"className\":\"hljs-title class_\",\"children\":\"PhysicalFileProvider\"}],\"(nextMount),\\n    \",[\"$\",\"span\",\"span-10\",{\"className\":\"hljs-title class_\",\"children\":\"RequestPath\"}],\" = \",[\"$\",\"span\",\"span-11\",{\"className\":\"hljs-string\",\"children\":\"\\\"/_next\\\"\"}],\"\\n});\\n\"]}]}],\"\\n\",[\"$\",\"p\",\"p-13\",{\"children\":\"That was pretty much it, we were able to re-use the code from the old solution and simply replaced the Azure functions proxy with a different one.\"}],\"\\n\",[\"$\",\"p\",\"p-14\",{\"children\":[\"Just after I wrote this blog post, Azure announced that Azure Static Web Apps will support Next.js with ISR/SSR \u0026 API routes soon. See the announcement about \",[\"$\",\"a\",\"a-0\",{\"href\":\"https://techcommunity.microsoft.com/t5/apps-on-azure-blog/extending-next-js-support-in-azure-static-web-apps/ba-p/3627975\",\"children\":\"Next.js support here\"}],\".\"]}],\"\\n\",[\"$\",\"p\",\"p-15\",{\"children\":\"Will be interesting to see if the Sitecore JSS Next.js SDK will also work with this, perhaps coming up in a blog post soon!\"}]]}]]}]\n"])</script><script>self.__next_f.push([1,"f:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n"])</script><script>self.__next_f.push([1,"d:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"1\",{\"children\":\"Sitecore JSS Next.js without Vercel\"}],[\"$\",\"meta\",\"2\",{\"name\":\"description\",\"content\":\"Erwin Smit - Freelance frontend developer / fullstack developer\"}],[\"$\",\"meta\",\"3\",{\"property\":\"og:title\",\"content\":\"Sitecore JSS Next.js without Vercel\"}],[\"$\",\"meta\",\"4\",{\"property\":\"og:description\",\"content\":\"Erwin Smit - Freelance frontend developer / fullstack developer\"}],[\"$\",\"meta\",\"5\",{\"name\":\"twitter:card\",\"content\":\"summary\"}],[\"$\",\"meta\",\"6\",{\"name\":\"twitter:title\",\"content\":\"Sitecore JSS Next.js without Vercel\"}],[\"$\",\"meta\",\"7\",{\"name\":\"twitter:description\",\"content\":\"Erwin Smit - Freelance frontend developer / fullstack developer\"}]]\n"])</script><script>self.__next_f.push([1,"b:null\n"])</script></body></html>